



<!DOCTYPE html>
<html lang="fa" class="no-js" data-version="v19.14" data-single-page="false">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://clickhouse.yandex/docs/fa/query_language/select/">
      
      
      
      <meta name="lang:clipboard.copy" content="کپی کردن">
      
      <meta name="lang:clipboard.copied" content="کپی شد">
      
      <meta name="lang:search.language" content="fa">
      
      <meta name="lang:search.pipeline.stopwords" content="False">
      
      <meta name="lang:search.pipeline.trimmer" content="False">
      
      <meta name="lang:search.result.none" content="سندی یافت نشد">
      
      <meta name="lang:search.result.one" content="1 سند یافت شد">
      
      <meta name="lang:search.result.other" content="# سند یافت شد">
      
      <meta name="lang:search.tokenizer" content="">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.ico">
    
    
      
        <title>SELECT - مستندات  v19.14ClickHouse</title>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
      <link rel="stylesheet" href="../../assets/stylesheets/application.2a88008a.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/custom.css?96b39be?1582217117">
    
    
  </head>
  
  
    
    
    <body dir="rtl" data-md-color-primary="white" data-md-color-accent="white" class="md-lang-fa">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">

  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="/" title="مستندات  v19.14ClickHouse" class="md-header-nav__button md-logo">
          
            <img src="../../images/logo.svg" width="40" height="40">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                مستندات  v19.14ClickHouse
              </span>
              <span class="md-header-nav__topic">
                SELECT
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" id="md-search__input" class="md-search__input" name="query" required placeholder="جستجو" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            برای شروع جستجو تایپ کنید
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div id="md-language-switch" class="md-header-nav__source">
            

  <a class="md-alt-lang"
     href="../../../en/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="English">
    <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 60 30"><clipPath id="t"><path d="M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z"/></clipPath><path fill="#00247d" d="M0,0 v30 h60 v-30 z"/><path stroke="#fff" stroke-width="6" d="M0,0 L60,30 M60,0 L0,30"/><path stroke="#cf142b" stroke-width="4" d="M0,0 L60,30 M60,0 L0,30" clip-path="url(#t)"/><path stroke="#fff" stroke-width="10" d="M30,0 v30 M0,15 h60"/><path stroke="#cf142b" stroke-width="6" d="M30,0 v30 M0,15 h60"/></svg>
  </a>

  <a class="md-alt-lang"
     href="../../../ru/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="Russian">
    <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 9 6"><rect width="9" height="3" fill="#fff"/><rect width="9" height="3" y="3" fill="#d52b1e"/><rect width="9" height="2" y="2" fill="#0039a6"/></svg>
  </a>

  <a class="md-alt-lang"
     href="../../../zh/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="Chinese">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="none" viewBox="0 0 30 20"><defs><path id="s" fill="#ffde00" d="M0,-1 0.587785,0.809017 -0.951057,-0.309017H0.951057L-0.587785,0.809017z"/></defs><rect width="30" height="20" fill="#de2910"/><use transform="translate(5,5) scale(3)" xlink:href="#s"/><use transform="translate(10,2) rotate(23.036243)" xlink:href="#s"/><use transform="translate(12,4) rotate(45.869898)" xlink:href="#s"/><use transform="translate(12,7) rotate(69.945396)" xlink:href="#s"/><use transform="translate(10,9) rotate(20.659808)" xlink:href="#s"/></svg>
  </a>

  <a class="md-alt-lang"
     href="../../../ja/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="Japanese">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="90" height="60" version="1.1" viewBox="0 0 90 60"><g id="surface1"><rect width="90" height="60" x="0" y="0" fill="#A0A0A0" fill-opacity="1" stroke="none"/><path fill="#FFF" fill-opacity="1" fill-rule="nonzero" stroke="none" d="M 0.601562 0.601562 L 89.398438 0.601562 L 89.398438 59.398438 L 0.601562 59.398438 Z M 0.601562 0.601562"/><path fill="#BE0026" fill-opacity="1" fill-rule="nonzero" stroke="none" d="M 63 30 C 63 39.941406 54.941406 48 45 48 C 35.058594 48 27 39.941406 27 30 C 27 20.058594 35.058594 12 45 12 C 54.941406 12 63 20.058594 63 30 Z M 63 30"/></g></svg>
  </a>

  <a class="md-alt-lang md-current-lang"
     href="../../../fa/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="Farsi">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="none" viewBox="0 0 630 360"><rect width="630" height="360" fill="#da0000"/><rect width="630" height="240" fill="#fff"/><rect width="630" height="120" fill="#239f40"/><g transform="translate(8.4,100.4)"><g id="tb4"><g id="tb1" fill="none" stroke="#fff" stroke-width="2"><path id="tbp1" d="M0,1H26M1,10V5H9V9H17V5H12M4,9H6M26,9H21V5H29M29,0V9H37V0M33,0V9" transform="scale(1.4)"/><path id="tbp2" d="M0,7H9M10,7H19" transform="scale(2.8)"/><use y="120" xlink:href="#tbp2"/><use y="145.2" xlink:href="#tbp1"/></g><g id="tb3"><use x="56" xlink:href="#tb1"/><use x="112" xlink:href="#tb1"/><use x="168" xlink:href="#tb1"/></g></g><use x="168" xlink:href="#tb3"/><use x="392" xlink:href="#tb4"/></g><g fill="#da0000" transform="matrix(45,0,0,45,315,180)"><g id="emblem_half"><path d="M-0.54815,0.83638A0.912046,0.912046 0 0,0 0.328544,-0.722384A1,1 0 0,1 -0.54815,0.83638"/><path d="M0.618339,0.661409A0.763932,0.763932 0 0,0 0.421644,-0.741049A1,1 0 0,1 0.618339,0.661409"/><path d="M0,1 -0.05,0 0,-0.787278A0.309995,0.309995 0 0,0 0.118034,-0.688191V-0.100406L0.077809,0.892905z"/><path d="M-0.02,-0.85 0,-0.831217A0.14431,0.14431 0 0,0 0.252075,-0.967708A0.136408,0.136408 0 0,1 0,-0.924634"/></g><use transform="scale(-1,1)" xlink:href="#emblem_half"/></g></svg>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
                      <nav class="md-nav md-nav--primary" data-md-level="0">
  
  <label class="md-nav__title md-nav__title--site" for="drawer">
    مستندات  v19.14ClickHouse
  </label>

  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../" title="ClickHouse چیست؟" class="md-nav__link">
      ClickHouse چیست؟
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../introduction/distinctive_features/" title=" ویژگی های برجسته ClickHouse" class="md-nav__link">
       ویژگی های برجسته ClickHouse
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../introduction/features_considered_disadvantages/" title=" ویژگی های از ClickHouse که می تواند معایبی باشد" class="md-nav__link">
       ویژگی های از ClickHouse که می تواند معایبی باشد
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../introduction/performance/" title="Performance" class="md-nav__link">
      Performance
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../introduction/ya_metrika_task/" title="The Yandex.Metrica task" class="md-nav__link">
      The Yandex.Metrica task
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Getting started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../getting_started/" title=" شروع به کار" class="md-nav__link">
       شروع به کار
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Example datasets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Example datasets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../getting_started/example_datasets/ontime/" title="OnTime" class="md-nav__link">
      OnTime
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../getting_started/example_datasets/nyc_taxi/" title=" داده های تاکسی New York" class="md-nav__link">
       داده های تاکسی New York
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../getting_started/example_datasets/amplab_benchmark/" title=" بنچمارک AMPLab Big Data" class="md-nav__link">
       بنچمارک AMPLab Big Data
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../getting_started/example_datasets/wikistat/" title="WikiStat" class="md-nav__link">
      WikiStat
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../getting_started/example_datasets/criteo/" title=" ترابایت از لاگ های کلیک از سرویس Criteo" class="md-nav__link">
       ترابایت از لاگ های کلیک از سرویس Criteo
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../getting_started/example_datasets/star_schema/" title=" بنچمارک Star Schema" class="md-nav__link">
       بنچمارک Star Schema
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../getting_started/example_datasets/metrica/" title="Yandex.Metrica Data" class="md-nav__link">
      Yandex.Metrica Data
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Interfaces
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Interfaces
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/" title="Interface ها" class="md-nav__link">
      Interface ها
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/cli/" title=" کلاینت Command-line" class="md-nav__link">
       کلاینت Command-line
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/tcp/" title="Native interface (TCP)" class="md-nav__link">
      Native interface (TCP)
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/http/" title="HTTP interface" class="md-nav__link">
      HTTP interface
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/formats/" title=" فرمت های Input و Output" class="md-nav__link">
       فرمت های Input و Output
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/jdbc/" title=" درایور JDBC" class="md-nav__link">
       درایور JDBC
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/odbc/" title=" درایور ODBC" class="md-nav__link">
       درایور ODBC
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      Third-party
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        Third-party
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/third-party/client_libraries/" title="کتابخانه های مشتری" class="md-nav__link">
      کتابخانه های مشتری
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/third-party/integrations/" title="یکپارچگی" class="md-nav__link">
      یکپارچگی
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/third-party/gui/" title="رابط های بصری" class="md-nav__link">
      رابط های بصری
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../interfaces/third-party/proxy/" title="پروکسی" class="md-nav__link">
      پروکسی
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Data types
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Data types
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/int_uint/" title="UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64" class="md-nav__link">
      UInt8, UInt16, UInt32, UInt64, Int8, Int16, Int32, Int64
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/float/" title="Float32, Float64" class="md-nav__link">
      Float32, Float64
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/decimal/" title="Decimal" class="md-nav__link">
      Decimal
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/boolean/" title=" مقادیر Boolean" class="md-nav__link">
       مقادیر Boolean
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/string/" title="String" class="md-nav__link">
      String
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/fixedstring/" title="FixedString(N)" class="md-nav__link">
      FixedString(N)
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/uuid/" title="UUID" class="md-nav__link">
      UUID
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/date/" title="Date" class="md-nav__link">
      Date
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/datetime/" title="DateTime" class="md-nav__link">
      DateTime
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/enum/" title="Enum" class="md-nav__link">
      Enum
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/array/" title="Array(T)" class="md-nav__link">
      Array(T)
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/nested_data_structures/aggregatefunction/" title="AggregateFunction(name, types_of_arguments...)" class="md-nav__link">
      AggregateFunction(name, types_of_arguments...)
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/tuple/" title="Tuple(T1, T2, ...)" class="md-nav__link">
      Tuple(T1, T2, ...)
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/nullable/" title="Nullable" class="md-nav__link">
      Nullable
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-16" type="checkbox" id="nav-4-16">
    
    <label class="md-nav__link" for="nav-4-16">
      Nested data structures
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-16">
        Nested data structures
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          
        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/nested_data_structures/nested/" title="Nested(Name1 Type1, Name2 Type2, ...)" class="md-nav__link">
      Nested(Name1 Type1, Name2 Type2, ...)
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-17" type="checkbox" id="nav-4-17">
    
    <label class="md-nav__link" for="nav-4-17">
      Special data types
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-17">
        Special data types
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          
        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/special_data_types/expression/" title="Expression" class="md-nav__link">
      Expression
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/special_data_types/set/" title="Set" class="md-nav__link">
      Set
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/special_data_types/nothing/" title="Nothing" class="md-nav__link">
      Nothing
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-18" type="checkbox" id="nav-4-18">
    
    <label class="md-nav__link" for="nav-4-18">
      Domains
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-18">
        Domains
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/domains/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/domains/ipv4/" title="IPv4" class="md-nav__link">
      IPv4
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../data_types/domains/ipv6/" title="IPv6" class="md-nav__link">
      IPv6
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Database Engines
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Database Engines
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../database_engines/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../database_engines/mysql/" title="MySQL" class="md-nav__link">
      MySQL
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Table Engines
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Table Engines
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      MergeTree Family
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        MergeTree Family
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/mergetree/" title="MergeTree" class="md-nav__link">
      MergeTree
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/replication/" title="Data Replication" class="md-nav__link">
      Data Replication
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/custom_partitioning_key/" title="Custom Partitioning Key" class="md-nav__link">
      Custom Partitioning Key
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/replacingmergetree/" title="ReplacingMergeTree" class="md-nav__link">
      ReplacingMergeTree
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/summingmergetree/" title="SummingMergeTree" class="md-nav__link">
      SummingMergeTree
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/aggregatingmergetree/" title="AggregatingMergeTree" class="md-nav__link">
      AggregatingMergeTree
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/collapsingmergetree/" title="CollapsingMergeTree" class="md-nav__link">
      CollapsingMergeTree
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/versionedcollapsingmergetree/" title="VersionedCollapsingMergeTree" class="md-nav__link">
      VersionedCollapsingMergeTree
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/graphitemergetree/" title="GraphiteMergeTree" class="md-nav__link">
      GraphiteMergeTree
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      Log Family
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        Log Family
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/log_family/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/stripelog/" title="StripeLog" class="md-nav__link">
      StripeLog
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/log/" title="Log" class="md-nav__link">
      Log
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/tinylog/" title="TinyLog" class="md-nav__link">
      TinyLog
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      Integrations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        Integrations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/kafka/" title="Kafka" class="md-nav__link">
      Kafka
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/mysql/" title="MySQL" class="md-nav__link">
      MySQL
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/jdbc/" title="JDBC" class="md-nav__link">
      JDBC
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/odbc/" title="ODBC" class="md-nav__link">
      ODBC
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      Special
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        Special
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/distributed/" title="Distributed" class="md-nav__link">
      Distributed
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/external_data/" title="External data" class="md-nav__link">
      External data
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/dictionary/" title="Dictionary" class="md-nav__link">
      Dictionary
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/merge/" title="Merge" class="md-nav__link">
      Merge
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/file/" title="File" class="md-nav__link">
      File
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/null/" title="Null" class="md-nav__link">
      Null
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/set/" title="Set" class="md-nav__link">
      Set
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/join/" title="Join" class="md-nav__link">
      Join
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/url/" title="URL" class="md-nav__link">
      URL
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/view/" title="View" class="md-nav__link">
      View
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/materializedview/" title="MaterializedView" class="md-nav__link">
      MaterializedView
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/memory/" title="Memory" class="md-nav__link">
      Memory
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/table_engines/buffer/" title="Buffer" class="md-nav__link">
      Buffer
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      


  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      SQL Reference
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        SQL Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          
        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        SELECT
      </label>
    
    <a href="../../query_language/select/" title="SELECT" class="md-nav__link md-nav__link--active">
      <strong>SELECT</strong>
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">فهرست موضوعات</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#with-clause" title="WITH Clause" class="md-nav__link">
    WITH Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-clause" title="FROM Clause" class="md-nav__link">
    FROM Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-sample-clause" title="SAMPLE Clause" class="md-nav__link">
    SAMPLE Clause
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#select-sample-k" title="SAMPLE k" class="md-nav__link">
    SAMPLE k
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-sample-n" title="SAMPLE n" class="md-nav__link">
    SAMPLE n
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-sample-offset" title="SAMPLE k OFFSET m" class="md-nav__link">
    SAMPLE k OFFSET m
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-array-join-clause" title="ARRAY JOIN Clause" class="md-nav__link">
    ARRAY JOIN Clause
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-aliases" title="Using Aliases" class="md-nav__link">
    Using Aliases
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array-join-with-nested-data-structure" title="ARRAY JOIN With Nested Data Structure" class="md-nav__link">
    ARRAY JOIN With Nested Data Structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-join" title="JOIN Clause" class="md-nav__link">
    JOIN Clause
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#select-join-types" title="Supported Types of JOIN" class="md-nav__link">
    Supported Types of JOIN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-join" title="Multiple JOIN" class="md-nav__link">
    Multiple JOIN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-join-strictness" title="Strictness" class="md-nav__link">
    Strictness
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-join" title="GLOBAL JOIN" class="md-nav__link">
    GLOBAL JOIN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-recommendations" title="Usage Recommendations" class="md-nav__link">
    Usage Recommendations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processing-of-empty-or-null-cells" title="Processing of Empty or NULL Cells" class="md-nav__link">
    Processing of Empty or NULL Cells
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syntax-limitations" title="Syntax Limitations" class="md-nav__link">
    Syntax Limitations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-clause" title="WHERE Clause" class="md-nav__link">
    WHERE Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prewhere-clause" title="PREWHERE Clause" class="md-nav__link">
    PREWHERE Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-group-by-clause" title="GROUP BY Clause" class="md-nav__link">
    GROUP BY Clause
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#null-processing" title="NULL processing" class="md-nav__link">
    NULL processing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-totals-modifier" title="WITH TOTALS Modifier" class="md-nav__link">
    WITH TOTALS Modifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-group-by-in-external-memory" title="GROUP BY in External Memory" class="md-nav__link">
    GROUP BY in External Memory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limit-by-clause" title="LIMIT BY Clause" class="md-nav__link">
    LIMIT BY Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#having-clause" title="HAVING Clause" class="md-nav__link">
    HAVING Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-order-by" title="ORDER BY Clause" class="md-nav__link">
    ORDER BY Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-clause" title="SELECT Clause" class="md-nav__link">
    SELECT Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-distinct" title="DISTINCT Clause" class="md-nav__link">
    DISTINCT Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limit-clause" title="LIMIT Clause" class="md-nav__link">
    LIMIT Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#union-all-clause" title="UNION ALL Clause" class="md-nav__link">
    UNION ALL Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#into-outfile-clause" title="INTO OUTFILE Clause" class="md-nav__link">
    INTO OUTFILE Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-clause" title="FORMAT Clause" class="md-nav__link">
    FORMAT Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-in-operators" title="IN Operators" class="md-nav__link">
    IN Operators
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#null-processing_1" title="NULL processing" class="md-nav__link">
    NULL processing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-distributed-subqueries" title="Distributed Subqueries" class="md-nav__link">
    Distributed Subqueries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extreme-values" title="Extreme Values" class="md-nav__link">
    Extreme Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" title="Notes" class="md-nav__link">
    Notes
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/insert_into/" title="INSERT INTO" class="md-nav__link">
      INSERT INTO
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/create/" title="CREATE" class="md-nav__link">
      CREATE
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/alter/" title="ALTER" class="md-nav__link">
      ALTER
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/system/" title="SYSTEM" class="md-nav__link">
      SYSTEM
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/misc/" title="Other Kinds of Queries" class="md-nav__link">
      Other Kinds of Queries
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-8" type="checkbox" id="nav-7-8">
    
    <label class="md-nav__link" for="nav-7-8">
      Functions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-8">
        Functions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/arithmetic_functions/" title="Arithmetic" class="md-nav__link">
      Arithmetic
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/comparison_functions/" title="Comparison" class="md-nav__link">
      Comparison
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/logical_functions/" title="Logical" class="md-nav__link">
      Logical
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/type_conversion_functions/" title="Type Conversion" class="md-nav__link">
      Type Conversion
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/date_time_functions/" title="Working with Dates and Times" class="md-nav__link">
      Working with Dates and Times
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/string_functions/" title="Working with strings" class="md-nav__link">
      Working with strings
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/string_search_functions/" title="For Searching Strings" class="md-nav__link">
      For Searching Strings
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/string_replace_functions/" title="For Replacing in Strings" class="md-nav__link">
      For Replacing in Strings
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/conditional_functions/" title="Conditional " class="md-nav__link">
      Conditional 
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/math_functions/" title="Mathematical" class="md-nav__link">
      Mathematical
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/rounding_functions/" title="Rounding" class="md-nav__link">
      Rounding
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/array_functions/" title="Working with Arrays" class="md-nav__link">
      Working with Arrays
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/splitting_merging_functions/" title="Splitting and Merging Strings and Arrays" class="md-nav__link">
      Splitting and Merging Strings and Arrays
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/bit_functions/" title="Bit" class="md-nav__link">
      Bit
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/bitmap_functions/" title="Bitmap" class="md-nav__link">
      Bitmap
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/hash_functions/" title="Hash" class="md-nav__link">
      Hash
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/random_functions/" title="Generating Pseudo-Random Numbers" class="md-nav__link">
      Generating Pseudo-Random Numbers
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/encoding_functions/" title="Encoding" class="md-nav__link">
      Encoding
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/uuid_functions/" title="Working with UUID" class="md-nav__link">
      Working with UUID
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/url_functions/" title="Working with URLs" class="md-nav__link">
      Working with URLs
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/ip_address_functions/" title="Working with IP Addresses" class="md-nav__link">
      Working with IP Addresses
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/json_functions/" title="Working with JSON." class="md-nav__link">
      Working with JSON.
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/higher_order_functions/" title="Higher-Order" class="md-nav__link">
      Higher-Order
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/ext_dict_functions/" title="Working with External Dictionaries" class="md-nav__link">
      Working with External Dictionaries
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/ym_dict_functions/" title="Working with Yandex.Metrica Dictionaries" class="md-nav__link">
      Working with Yandex.Metrica Dictionaries
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/in_functions/" title="Implementing the IN Operator" class="md-nav__link">
      Implementing the IN Operator
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/array_join/" title="arrayJoin" class="md-nav__link">
      arrayJoin
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/geo/" title="Working with geographical coordinates" class="md-nav__link">
      Working with geographical coordinates
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/functions_for_nulls/" title="Working with Nullable arguments" class="md-nav__link">
      Working with Nullable arguments
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/machine_learning_functions/" title="Machine Learning Functions" class="md-nav__link">
      Machine Learning Functions
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/functions/other_functions/" title="Other" class="md-nav__link">
      Other
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-9" type="checkbox" id="nav-7-9">
    
    <label class="md-nav__link" for="nav-7-9">
      Aggregate Functions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-9">
        Aggregate Functions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/agg_functions/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/agg_functions/reference/" title="Reference" class="md-nav__link">
      Reference
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/agg_functions/combinators/" title="Aggregate function combinators" class="md-nav__link">
      Aggregate function combinators
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/agg_functions/parametric_functions/" title="Parametric aggregate functions" class="md-nav__link">
      Parametric aggregate functions
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-10" type="checkbox" id="nav-7-10">
    
    <label class="md-nav__link" for="nav-7-10">
      Table Functions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-10">
        Table Functions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/table_functions/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/table_functions/file/" title="file" class="md-nav__link">
      file
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/table_functions/merge/" title="merge" class="md-nav__link">
      merge
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/table_functions/numbers/" title="numbers" class="md-nav__link">
      numbers
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/table_functions/remote/" title="remote" class="md-nav__link">
      remote
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/table_functions/url/" title="url" class="md-nav__link">
      url
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/table_functions/mysql/" title="mysql" class="md-nav__link">
      mysql
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/table_functions/jdbc/" title="jdbc" class="md-nav__link">
      jdbc
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/table_functions/odbc/" title="odbc" class="md-nav__link">
      odbc
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-11" type="checkbox" id="nav-7-11">
    
    <label class="md-nav__link" for="nav-7-11">
      Dictionaries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-11">
        Dictionaries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/dicts/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-11-2" type="checkbox" id="nav-7-11-2">
    
    <label class="md-nav__link" for="nav-7-11-2">
      External Dictionaries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-11-2">
        External Dictionaries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/dicts/external_dicts/" title="General Description" class="md-nav__link">
      General Description
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/dicts/external_dicts_dict/" title="Configuring an External Dictionary" class="md-nav__link">
      Configuring an External Dictionary
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/dicts/external_dicts_dict_layout/" title="Storing Dictionaries in Memory" class="md-nav__link">
      Storing Dictionaries in Memory
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/dicts/external_dicts_dict_lifetime/" title="Dictionary Updates" class="md-nav__link">
      Dictionary Updates
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/dicts/external_dicts_dict_sources/" title="Sources of External Dictionaries" class="md-nav__link">
      Sources of External Dictionaries
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/dicts/external_dicts_dict_structure/" title="Dictionary Key and Fields" class="md-nav__link">
      Dictionary Key and Fields
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/dicts/internal_dicts/" title="Internal Dictionaries" class="md-nav__link">
      Internal Dictionaries
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/operators/" title="Operators" class="md-nav__link">
      Operators
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../query_language/syntax/" title="General Syntax" class="md-nav__link">
      General Syntax
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Operations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Operations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/requirements/" title="Requirements" class="md-nav__link">
      Requirements
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/monitoring/" title="Monitoring" class="md-nav__link">
      Monitoring
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/tips/" title="Usage Recommendations" class="md-nav__link">
      Usage Recommendations
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/update/" title="ClickHouse Update" class="md-nav__link">
      ClickHouse Update
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/access_rights/" title="Access Rights" class="md-nav__link">
      Access Rights
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/backup/" title="Data Backup" class="md-nav__link">
      Data Backup
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/configuration_files/" title="Configuration Files" class="md-nav__link">
      Configuration Files
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/quotas/" title="Quotas" class="md-nav__link">
      Quotas
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/system_tables/" title="System Tables" class="md-nav__link">
      System Tables
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-12" type="checkbox" id="nav-8-12">
    
    <label class="md-nav__link" for="nav-8-12">
      Server Configuration Parameters
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-12">
        Server Configuration Parameters
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/server_settings/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/server_settings/settings/" title="Server Settings" class="md-nav__link">
      Server Settings
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-13" type="checkbox" id="nav-8-13">
    
    <label class="md-nav__link" for="nav-8-13">
      Settings
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-13">
        Settings
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/settings/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/settings/permissions_for_queries/" title="Permissions for Queries" class="md-nav__link">
      Permissions for Queries
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/settings/query_complexity/" title="Restrictions on Query Complexity" class="md-nav__link">
      Restrictions on Query Complexity
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/settings/settings/" title="Settings" class="md-nav__link">
      Settings
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/settings/settings_profiles/" title="Settings Profiles" class="md-nav__link">
      Settings Profiles
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/settings/settings_users/" title="User Settings" class="md-nav__link">
      User Settings
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/settings/constraints_on_settings/" title="Constraints on Settings" class="md-nav__link">
      Constraints on Settings
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
          
          
          



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-14" type="checkbox" id="nav-8-14">
    
    <label class="md-nav__link" for="nav-8-14">
      Utilities
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-14">
        Utilities
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/utils/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/utils/clickhouse-copier/" title="clickhouse-copier" class="md-nav__link">
      clickhouse-copier
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../operations/utils/clickhouse-local/" title="clickhouse-local" class="md-nav__link">
      clickhouse-local
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      F.A.Q.
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        F.A.Q.
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../faq/general/" title="General Questions" class="md-nav__link">
      General Questions
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          
        
          
          
          



  <li class="md-nav__item">
    <a href="../../development/architecture/" title="Overview of ClickHouse Architecture" class="md-nav__link">
      Overview of ClickHouse Architecture
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../development/build/" title="How to Build ClickHouse on Linux" class="md-nav__link">
      How to Build ClickHouse on Linux
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../development/build_osx/" title="How to Build ClickHouse on Mac OS X" class="md-nav__link">
      How to Build ClickHouse on Mac OS X
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../development/style/" title="How to Write C++ code" class="md-nav__link">
      How to Write C++ code
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../development/tests/" title="How to Run ClickHouse Tests" class="md-nav__link">
      How to Run ClickHouse Tests
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../development/contrib/" title="Third-Party Libraries Used" class="md-nav__link">
      Third-Party Libraries Used
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


    
      
      
      



  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      What's New
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        What's New
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>


        
          
          
          



  <li class="md-nav__item">
    <a href="../../security_changelog/" title="Security Changelog" class="md-nav__link">
      Security Changelog
    </a>
  </li>


        
      </ul>
    </nav>
  </li>


    
  </ul>
  

  <ul id="md-extra-nav" class="md-nav__list" data-md-scrollfix>
    <li class="md-nav__item md-nav__item--active">
      رهایی:
      <span class="md-selector">
        <select id="releases-selector">
          <option value="">آخرین</option>
          
            <option value="v20.1"
              
            >v20.1</option>
          
            <option value="v19.17"
              
            >v19.17</option>
          
            <option value="v19.16"
              
            >v19.16</option>
          
            <option value="v19.15"
              
            >v19.15</option>
          
            <option value="v19.14"
              
                selected="selected"
              
            >v19.14</option>
          
            <option value="v19.13"
              
            >v19.13</option>
          
            <option value="v19.11"
              
            >v19.11</option>
          
            <option value="v19.10"
              
            >v19.10</option>
          
            <option value="v19.9"
              
            >v19.9</option>
          
            <option value="v19.8"
              
            >v19.8</option>
          
            <option value="v19.7"
              
            >v19.7</option>
          
        </select><span id="releases-selector-after">&nbsp;▾</span>
      </span>
    </li>
    <li class="md-nav__item md-nav__item--active">
        
          <a href="../../single/" class="md-nav__link md-nav__link--active">نسخه تک صفحه</a>
        
    </li>
    <li class="md-nav__item md-nav__item--active">
          <a href="../../single/clickhouse_fa.pdf" class="md-nav__link md-nav__link--active">نسخه PDF</a>
    </li>
    
    <li class="md-nav__item md-nav__item--active">
      <a href="https://github.com/ClickHouse/ClickHouse/" rel="external nofollow" target="_blank" class="md-nav__link">
        کد منبع کلیک
      </a>
    </li>
    
    <li class="md-nav__item md-nav__item--active">
        <span id="md-sidebar-flags" class="md-nav__link">
        

  <a class="md-alt-lang"
     href="../../../en/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="English">
    <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 60 30"><clipPath id="t"><path d="M30,15 h30 v15 z v15 h-30 z h-30 v-15 z v-15 h30 z"/></clipPath><path fill="#00247d" d="M0,0 v30 h60 v-30 z"/><path stroke="#fff" stroke-width="6" d="M0,0 L60,30 M60,0 L0,30"/><path stroke="#cf142b" stroke-width="4" d="M0,0 L60,30 M60,0 L0,30" clip-path="url(#t)"/><path stroke="#fff" stroke-width="10" d="M30,0 v30 M0,15 h60"/><path stroke="#cf142b" stroke-width="6" d="M30,0 v30 M0,15 h60"/></svg>
  </a>

  <a class="md-alt-lang"
     href="../../../ru/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="Russian">
    <svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none" viewBox="0 0 9 6"><rect width="9" height="3" fill="#fff"/><rect width="9" height="3" y="3" fill="#d52b1e"/><rect width="9" height="2" y="2" fill="#0039a6"/></svg>
  </a>

  <a class="md-alt-lang"
     href="../../../zh/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="Chinese">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="none" viewBox="0 0 30 20"><defs><path id="s" fill="#ffde00" d="M0,-1 0.587785,0.809017 -0.951057,-0.309017H0.951057L-0.587785,0.809017z"/></defs><rect width="30" height="20" fill="#de2910"/><use transform="translate(5,5) scale(3)" xlink:href="#s"/><use transform="translate(10,2) rotate(23.036243)" xlink:href="#s"/><use transform="translate(12,4) rotate(45.869898)" xlink:href="#s"/><use transform="translate(12,7) rotate(69.945396)" xlink:href="#s"/><use transform="translate(10,9) rotate(20.659808)" xlink:href="#s"/></svg>
  </a>

  <a class="md-alt-lang"
     href="../../../ja/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="Japanese">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="90" height="60" version="1.1" viewBox="0 0 90 60"><g id="surface1"><rect width="90" height="60" x="0" y="0" fill="#A0A0A0" fill-opacity="1" stroke="none"/><path fill="#FFF" fill-opacity="1" fill-rule="nonzero" stroke="none" d="M 0.601562 0.601562 L 89.398438 0.601562 L 89.398438 59.398438 L 0.601562 59.398438 Z M 0.601562 0.601562"/><path fill="#BE0026" fill-opacity="1" fill-rule="nonzero" stroke="none" d="M 63 30 C 63 39.941406 54.941406 48 45 48 C 35.058594 48 27 39.941406 27 30 C 27 20.058594 35.058594 12 45 12 C 54.941406 12 63 20.058594 63 30 Z M 63 30"/></g></svg>
  </a>

  <a class="md-alt-lang md-current-lang"
     href="../../../fa/query_language/select/" class="md-flex__ellipsis md-header-nav__title"
     title="Farsi">
    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="none" viewBox="0 0 630 360"><rect width="630" height="360" fill="#da0000"/><rect width="630" height="240" fill="#fff"/><rect width="630" height="120" fill="#239f40"/><g transform="translate(8.4,100.4)"><g id="tb4"><g id="tb1" fill="none" stroke="#fff" stroke-width="2"><path id="tbp1" d="M0,1H26M1,10V5H9V9H17V5H12M4,9H6M26,9H21V5H29M29,0V9H37V0M33,0V9" transform="scale(1.4)"/><path id="tbp2" d="M0,7H9M10,7H19" transform="scale(2.8)"/><use y="120" xlink:href="#tbp2"/><use y="145.2" xlink:href="#tbp1"/></g><g id="tb3"><use x="56" xlink:href="#tb1"/><use x="112" xlink:href="#tb1"/><use x="168" xlink:href="#tb1"/></g></g><use x="168" xlink:href="#tb3"/><use x="392" xlink:href="#tb4"/></g><g fill="#da0000" transform="matrix(45,0,0,45,315,180)"><g id="emblem_half"><path d="M-0.54815,0.83638A0.912046,0.912046 0 0,0 0.328544,-0.722384A1,1 0 0,1 -0.54815,0.83638"/><path d="M0.618339,0.661409A0.763932,0.763932 0 0,0 0.421644,-0.741049A1,1 0 0,1 0.618339,0.661409"/><path d="M0,1 -0.05,0 0,-0.787278A0.309995,0.309995 0 0,0 0.118034,-0.688191V-0.100406L0.077809,0.892905z"/><path d="M-0.02,-0.85 0,-0.831217A0.14431,0.14431 0 0,0 0.252075,-0.967708A0.136408,0.136408 0 0,1 0,-0.924634"/></g><use transform="scale(-1,1)" xlink:href="#emblem_half"/></g></svg>
  </a>

        </span>
    </li>
  </ul>
</nav>
                    
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
                      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">فهرست موضوعات</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#with-clause" title="WITH Clause" class="md-nav__link">
    WITH Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-clause" title="FROM Clause" class="md-nav__link">
    FROM Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-sample-clause" title="SAMPLE Clause" class="md-nav__link">
    SAMPLE Clause
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#select-sample-k" title="SAMPLE k" class="md-nav__link">
    SAMPLE k
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-sample-n" title="SAMPLE n" class="md-nav__link">
    SAMPLE n
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-sample-offset" title="SAMPLE k OFFSET m" class="md-nav__link">
    SAMPLE k OFFSET m
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-array-join-clause" title="ARRAY JOIN Clause" class="md-nav__link">
    ARRAY JOIN Clause
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-aliases" title="Using Aliases" class="md-nav__link">
    Using Aliases
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#array-join-with-nested-data-structure" title="ARRAY JOIN With Nested Data Structure" class="md-nav__link">
    ARRAY JOIN With Nested Data Structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-join" title="JOIN Clause" class="md-nav__link">
    JOIN Clause
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#select-join-types" title="Supported Types of JOIN" class="md-nav__link">
    Supported Types of JOIN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-join" title="Multiple JOIN" class="md-nav__link">
    Multiple JOIN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-join-strictness" title="Strictness" class="md-nav__link">
    Strictness
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-join" title="GLOBAL JOIN" class="md-nav__link">
    GLOBAL JOIN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-recommendations" title="Usage Recommendations" class="md-nav__link">
    Usage Recommendations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#processing-of-empty-or-null-cells" title="Processing of Empty or NULL Cells" class="md-nav__link">
    Processing of Empty or NULL Cells
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#syntax-limitations" title="Syntax Limitations" class="md-nav__link">
    Syntax Limitations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#where-clause" title="WHERE Clause" class="md-nav__link">
    WHERE Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prewhere-clause" title="PREWHERE Clause" class="md-nav__link">
    PREWHERE Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-group-by-clause" title="GROUP BY Clause" class="md-nav__link">
    GROUP BY Clause
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#null-processing" title="NULL processing" class="md-nav__link">
    NULL processing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#with-totals-modifier" title="WITH TOTALS Modifier" class="md-nav__link">
    WITH TOTALS Modifier
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-group-by-in-external-memory" title="GROUP BY in External Memory" class="md-nav__link">
    GROUP BY in External Memory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limit-by-clause" title="LIMIT BY Clause" class="md-nav__link">
    LIMIT BY Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#having-clause" title="HAVING Clause" class="md-nav__link">
    HAVING Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-order-by" title="ORDER BY Clause" class="md-nav__link">
    ORDER BY Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-clause" title="SELECT Clause" class="md-nav__link">
    SELECT Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-distinct" title="DISTINCT Clause" class="md-nav__link">
    DISTINCT Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limit-clause" title="LIMIT Clause" class="md-nav__link">
    LIMIT Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#union-all-clause" title="UNION ALL Clause" class="md-nav__link">
    UNION ALL Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#into-outfile-clause" title="INTO OUTFILE Clause" class="md-nav__link">
    INTO OUTFILE Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-clause" title="FORMAT Clause" class="md-nav__link">
    FORMAT Clause
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#select-in-operators" title="IN Operators" class="md-nav__link">
    IN Operators
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#null-processing_1" title="NULL processing" class="md-nav__link">
    NULL processing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-distributed-subqueries" title="Distributed Subqueries" class="md-nav__link">
    Distributed Subqueries
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extreme-values" title="Extreme Values" class="md-nav__link">
    Extreme Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notes" title="Notes" class="md-nav__link">
    Notes
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                    
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  
                    <a href="https://github.com/ClickHouse/ClickHouse/edit/master/docs/fa/query_language/select.md" title="این صفحه را ویرایش کنید" class="md-icon md-content__icon" rel="external nofollow">&#xE3C9;</a>
                  
                
                
                <div id="content">
                
                  <h1 id="select-queries-syntax">SELECT Queries Syntax<a class="headerlink" href="#select-queries-syntax" title="Permanent link">&para;</a></h1>
<p><code>SELECT</code> performs data retrieval.</p>
<div class="codehilite"><pre><span></span><span class="p">[</span><span class="k">WITH</span> <span class="n">expr_list</span><span class="o">|</span><span class="p">(</span><span class="n">subquery</span><span class="p">)]</span>
<span class="k">SELECT</span> <span class="p">[</span><span class="k">DISTINCT</span><span class="p">]</span> <span class="n">expr_list</span>
<span class="p">[</span><span class="k">FROM</span> <span class="p">[</span><span class="n">db</span><span class="p">.]</span><span class="k">table</span> <span class="o">|</span> <span class="p">(</span><span class="n">subquery</span><span class="p">)</span> <span class="o">|</span> <span class="n">table_function</span><span class="p">]</span> <span class="p">[</span><span class="k">FINAL</span><span class="p">]</span>
<span class="p">[</span><span class="n">SAMPLE</span> <span class="n">sample_coeff</span><span class="p">]</span>
<span class="p">[</span><span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="p">...]</span>
<span class="p">[</span><span class="k">GLOBAL</span><span class="p">]</span> <span class="p">[</span><span class="k">ANY</span><span class="o">|</span><span class="k">ALL</span><span class="p">]</span> <span class="p">[</span><span class="k">INNER</span><span class="o">|</span><span class="k">LEFT</span><span class="o">|</span><span class="k">RIGHT</span><span class="o">|</span><span class="k">FULL</span><span class="o">|</span><span class="k">CROSS</span><span class="p">]</span> <span class="p">[</span><span class="k">OUTER</span><span class="p">]</span> <span class="k">JOIN</span> <span class="p">(</span><span class="n">subquery</span><span class="p">)</span><span class="o">|</span><span class="k">table</span> <span class="k">USING</span> <span class="n">columns_list</span>
<span class="p">[</span><span class="n">PREWHERE</span> <span class="n">expr</span><span class="p">]</span>
<span class="p">[</span><span class="k">WHERE</span> <span class="n">expr</span><span class="p">]</span>
<span class="p">[</span><span class="k">GROUP</span> <span class="k">BY</span> <span class="n">expr_list</span><span class="p">]</span> <span class="p">[</span><span class="k">WITH</span> <span class="n">TOTALS</span><span class="p">]</span>
<span class="p">[</span><span class="k">HAVING</span> <span class="n">expr</span><span class="p">]</span>
<span class="p">[</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">expr_list</span><span class="p">]</span>
<span class="p">[</span><span class="k">LIMIT</span> <span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">]</span><span class="n">m</span><span class="p">]</span>
<span class="p">[</span><span class="k">UNION</span> <span class="k">ALL</span> <span class="p">...]</span>
<span class="p">[</span><span class="k">INTO</span> <span class="n">OUTFILE</span> <span class="n">filename</span><span class="p">]</span>
<span class="p">[</span><span class="n">FORMAT</span> <span class="n">format</span><span class="p">]</span>
<span class="p">[</span><span class="k">LIMIT</span> <span class="p">[</span><span class="n">offset_value</span><span class="p">,</span> <span class="p">]</span><span class="n">n</span> <span class="k">BY</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>


<p>All the clauses are optional, except for the required list of expressions immediately after SELECT.
The clauses below are described in almost the same order as in the query execution conveyor.</p>
<p>If the query omits the <code>DISTINCT</code>, <code>GROUP BY</code> and <code>ORDER BY</code> clauses and the <code>IN</code> and <code>JOIN</code> subqueries, the query will be completely stream processed, using O(1) amount of RAM.
Otherwise, the query might consume a lot of RAM if the appropriate restrictions are not specified: <code>max_memory_usage</code>, <code>max_rows_to_group_by</code>, <code>max_rows_to_sort</code>, <code>max_rows_in_distinct</code>, <code>max_bytes_in_distinct</code>, <code>max_rows_in_set</code>, <code>max_bytes_in_set</code>, <code>max_rows_in_join</code>, <code>max_bytes_in_join</code>, <code>max_bytes_before_external_sort</code>, <code>max_bytes_before_external_group_by</code>. For more information, see the section "Settings". It is possible to use external sorting (saving temporary tables to a disk) and external aggregation. <code>The system does not have "merge join"</code>.</p>
<h3 id="with-clause">WITH Clause<a class="headerlink" href="#with-clause" title="Permanent link">&para;</a></h3>
<p>This section provides support for Common Table Expressions (<a href="https://en.wikipedia.org/wiki/Hierarchical_and_recursive_queries_in_SQL" rel="external nofollow">CTE</a>), with some limitations:
1. Recursive queries are not supported
2. When subquery is used inside WITH section, it's result should be scalar with exactly one row
3. Expression's results are not available in subqueries
Results of WITH clause expressions can be used inside SELECT clause.</p>
<p>Example 1: Using constant expression as "variable"</p>
<div class="codehilite"><pre><span></span><span class="err">WITH &#39;2019-08-01 15:23:00&#39; as ts_upper_bound</span>
<span class="err">SELECT *</span>
<span class="err">FROM hits</span>
<span class="err">WHERE</span>
<span class="err">    EventDate = toDate(ts_upper_bound) AND</span>
<span class="err">    EventTime &lt;= ts_upper_bound</span>
</pre></div>


<p>Example 2: Evicting sum(bytes) expression result from SELECT clause column list</p>
<div class="codehilite"><pre><span></span><span class="err">WITH sum(bytes) as s</span>
<span class="err">SELECT</span>
<span class="err">    formatReadableSize(s),</span>
<span class="err">    table</span>
<span class="err">FROM system.parts</span>
<span class="err">GROUP BY table</span>
<span class="err">ORDER BY s</span>
</pre></div>


<p>Example 3: Using results of scalar subquery</p>
<div class="codehilite"><pre><span></span><span class="err">/* this example would return TOP 10 of most huge tables */</span>
<span class="err">WITH</span>
<span class="err">    (</span>
<span class="err">        SELECT sum(bytes)</span>
<span class="err">        FROM system.parts</span>
<span class="err">        WHERE active</span>
<span class="err">    ) AS total_disk_usage</span>
<span class="err">SELECT</span>
<span class="err">    (sum(bytes) / total_disk_usage) * 100 AS table_disk_usage,</span>
<span class="err">    table</span>
<span class="err">FROM system.parts</span>
<span class="err">GROUP BY table</span>
<span class="err">ORDER BY table_disk_usage DESC</span>
<span class="err">LIMIT 10</span>
</pre></div>


<p>Example 4: Re-using expression in subquery
As a workaround for current limitation for expression usage in subqueries, you may duplicate it.</p>
<div class="codehilite"><pre><span></span><span class="k">WITH</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">]</span> <span class="k">AS</span> <span class="n">hello</span>
<span class="k">SELECT</span>
    <span class="n">hello</span><span class="p">,</span>
    <span class="o">*</span>
<span class="k">FROM</span>
<span class="p">(</span>
    <span class="k">WITH</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">]</span> <span class="k">AS</span> <span class="n">hello</span>
    <span class="k">SELECT</span> <span class="n">hello</span>
<span class="p">)</span>

<span class="err">┌─</span><span class="n">hello</span><span class="err">─────┬─</span><span class="n">hello</span><span class="err">─────┐</span>
<span class="err">│</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">]</span> <span class="err">│</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">]</span> <span class="err">│</span>
<span class="err">└───────────┴───────────┘</span>
</pre></div>


<h3 id="from-clause">FROM Clause<a class="headerlink" href="#from-clause" title="Permanent link">&para;</a></h3>
<p>If the FROM clause is omitted, data will be read from the <code>system.one</code> table.
The 'system.one' table contains exactly one row (this table fulfills the same purpose as the DUAL table found in other DBMSs).</p>
<p>The FROM clause specifies the table to read data from, or a subquery, or a table function; ARRAY JOIN and the regular JOIN may also be included (see below).</p>
<p>Instead of a table, the SELECT subquery may be specified in brackets.
In this case, the subquery processing pipeline will be built into the processing pipeline of an external query.
In contrast to standard SQL, a synonym does not need to be specified after a subquery. For compatibility, it is possible to write 'AS name' after a subquery, but the specified name isn't used anywhere.</p>
<p>A table function may be specified instead of a table. For more information, see the section "Table functions".</p>
<p>To execute a query, all the columns listed in the query are extracted from the appropriate table. Any columns not needed for the external query are thrown out of the subqueries.
If a query does not list any columns (for example, SELECT count() FROM t), some column is extracted from the table anyway (the smallest one is preferred), in order to calculate the number of rows.</p>
<p>The FINAL modifier can be used only for a SELECT from ReplacingMergeTree, SummingMergeTree, AggregatingMergeTree, CollapsingMergeTree and VersionedCollapsingMergeTree tables. When you specify FINAL, data is selected fully "merged". Keep in mind that using FINAL leads to a selection that includes columns related to the primary key, in addition to the columns specified in the SELECT. Additionally, the query will be executed in a single stream, and data will be merged during query execution. This means that when using FINAL, the query is processed more slowly. In most cases, you should avoid using FINAL.</p>
<h3 id="select-sample-clause">SAMPLE Clause<a class="headerlink" href="#select-sample-clause" title="Permanent link">&para;</a></h3>
<p>The <code>SAMPLE</code> clause allows for approximated query processing.</p>
<p>When data sampling is enabled, the query is not performed on all the data, but only on a certain fraction of data (sample). For example, if you need to calculate statistics for all the visits, it is enough to execute the query on the 1/10 fraction of all the visits and then multiply the result by 10.</p>
<p>Approximated query processing can be useful in the following cases:</p>
<ul>
<li>When you have strict timing requirements (like &lt;100ms) but you can't justify the cost of additional hardware resources to meet them.</li>
<li>When your raw data is not accurate, so approximation doesn't noticeably degrade the quality.</li>
<li>Business requirements target approximate results (for cost-effectiveness, or in order to market exact results to premium users).</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can only use sampling with the tables in the <a href="../../operations/table_engines/mergetree/">MergeTree</a> family, and only if the sampling expression was specified during table creation (see <a href="../../operations/table_engines/mergetree/#table_engine-mergetree-creating-a-table">MergeTree engine</a>).</p>
</div>
<p>The features of data sampling are listed below:</p>
<ul>
<li>Data sampling is a deterministic mechanism. The result of the same <code>SELECT .. SAMPLE</code> query is always the same.</li>
<li>Sampling works consistently for different tables. For tables with a single sampling key, a sample with the same coefficient always selects the same subset of possible data. For example, a sample of user IDs takes rows with the same subset of all the possible user IDs from different tables. This means that you can use the sample in subqueries in the <a href="#select-in-operators">IN</a> clause. Also, you can join samples using the <a href="#select-join">JOIN</a> clause.</li>
<li>Sampling allows reading less data from a disk. Note that you must specify the sampling key correctly. For more information, see <a href="../../operations/table_engines/mergetree/#table_engine-mergetree-creating-a-table">Creating a MergeTree Table</a>.</li>
</ul>
<p>For the <code>SAMPLE</code> clause the following syntax is supported:</p>
<table>
<thead>
<tr>
<th>SAMPLE&#160;Clause&#160;Syntax</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SAMPLE k</code></td>
<td>Here <code>k</code> is the number from 0 to 1.</br>The query is executed on <code>k</code> fraction of data. For example, <code>SAMPLE 0.1</code> runs the query on 10% of data. <a href="#select-sample-k">Read more</a></td>
</tr>
<tr>
<td><code>SAMPLE n</code></td>
<td>Here <code>n</code> is a sufficiently large integer.</br>The query is executed on a sample of at least <code>n</code> rows (but not significantly more than this). For example, <code>SAMPLE 10000000</code> runs the query on a minimum of 10,000,000 rows. <a href="#select-sample-n">Read more</a></td>
</tr>
<tr>
<td><code>SAMPLE k OFFSET m</code></td>
<td>Here <code>k</code> and <code>m</code> are the numbers from 0 to 1.</br>The query is executed on a sample of <code>k</code> fraction of the data. The data used for the sample is offset by <code>m</code> fraction. <a href="#select-sample-offset">Read more</a></td>
</tr>
</tbody>
</table>
<h4 id="select-sample-k">SAMPLE k<a class="headerlink" href="#select-sample-k" title="Permanent link">&para;</a></h4>
<p>Here <code>k</code> is the number from 0 to 1 (both fractional and decimal notations are supported). For example, <code>SAMPLE 1/2</code> or <code>SAMPLE 0.5</code>.</p>
<p>In a <code>SAMPLE k</code> clause, the sample is taken from the <code>k</code> fraction of data. The example is shown below:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">Title</span><span class="p">,</span>
    <span class="k">count</span><span class="p">()</span> <span class="o">*</span> <span class="mi">10</span> <span class="k">AS</span> <span class="n">PageViews</span>
<span class="k">FROM</span> <span class="n">hits_distributed</span>
<span class="n">SAMPLE</span> <span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
<span class="k">WHERE</span>
    <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">34</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">Title</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">PageViews</span> <span class="k">DESC</span> <span class="k">LIMIT</span> <span class="mi">1000</span>
</pre></div>


<p>In this example, the query is executed on a sample from 0.1 (10%) of data. Values of aggregate functions are not corrected automatically, so to get an approximate result, the value <code>count()</code> is manually multiplied by 10.</p>
<h4 id="select-sample-n">SAMPLE n<a class="headerlink" href="#select-sample-n" title="Permanent link">&para;</a></h4>
<p>Here <code>n</code> is a sufficiently large integer. For example, <code>SAMPLE 10000000</code>.</p>
<p>In this case, the query is executed on a sample of at least <code>n</code> rows (but not significantly more than this). For example, <code>SAMPLE 10000000</code> runs the query on a minimum of 10,000,000 rows.</p>
<p>Since the minimum unit for data reading is one granule (its size is set by the <code>index_granularity</code> setting), it makes sense to set a sample that is much larger than the size of the granule.</p>
<p>When using the <code>SAMPLE n</code> clause, you don't know which relative percent of data was processed. So you don't know the coefficient the aggregate functions should be multiplied by. Use the <code>_sample_factor</code> virtual column to get the approximate result.</p>
<p>The <code>_sample_factor</code> column contains relative coefficients that are calculated dynamically. This column is created automatically when you <a href="../../operations/table_engines/mergetree/#table_engine-mergetree-creating-a-table">create</a> a table with the specified sampling key. The usage examples of the <code>_sample_factor</code> column are shown below.</p>
<p>Let's consider the table <code>visits</code>, which contains the statistics about site visits. The first example shows how to calculate the number of page views:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="k">sum</span><span class="p">(</span><span class="n">PageViews</span> <span class="o">*</span> <span class="n">_sample_factor</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">visits</span>
<span class="n">SAMPLE</span> <span class="mi">10000000</span>
</pre></div>


<p>The next example shows how to calculate the total number of visits:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="k">sum</span><span class="p">(</span><span class="n">_sample_factor</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">visits</span>
<span class="n">SAMPLE</span> <span class="mi">10000000</span>
</pre></div>


<p>The example below shows how to calculate the average session duration. Note that you don't need to use the relative coefficient to calculate the average values.</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">Duration</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">visits</span>
<span class="n">SAMPLE</span> <span class="mi">10000000</span>
</pre></div>


<h4 id="select-sample-offset">SAMPLE k OFFSET m<a class="headerlink" href="#select-sample-offset" title="Permanent link">&para;</a></h4>
<p>Here <code>k</code> and <code>m</code> are numbers from 0 to 1. Examples are shown below.</p>
<p><strong>Example 1</strong></p>
<div class="codehilite"><pre><span></span><span class="n">SAMPLE</span> <span class="mi">1</span><span class="o">/</span><span class="mi">10</span>
</pre></div>


<p>In this example, the sample is 1/10th of all data:</p>
<p><code>[++------------------]</code></p>
<p><strong>Example 2</strong></p>
<div class="codehilite"><pre><span></span><span class="n">SAMPLE</span> <span class="mi">1</span><span class="o">/</span><span class="mi">10</span> <span class="k">OFFSET</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span>
</pre></div>


<p>Here, a sample of 10% is taken from the second half of the data.</p>
<p><code>[----------++--------]</code></p>
<h3 id="select-array-join-clause">ARRAY JOIN Clause<a class="headerlink" href="#select-array-join-clause" title="Permanent link">&para;</a></h3>
<p>Allows executing <code>JOIN</code> with an array or nested data structure. The intent is similar to the <a href="../functions/array_join/#functions_arrayjoin">arrayJoin</a> function, but its functionality is broader.</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">expr_list</span><span class="o">&gt;</span>
<span class="k">FROM</span> <span class="o">&lt;</span><span class="n">left_subquery</span><span class="o">&gt;</span>
<span class="p">[</span><span class="k">LEFT</span><span class="p">]</span> <span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="o">&lt;</span><span class="nb">array</span><span class="o">&gt;</span>
<span class="p">[</span><span class="k">WHERE</span><span class="o">|</span><span class="n">PREWHERE</span> <span class="o">&lt;</span><span class="n">expr</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">...</span>
</pre></div>


<p>You can specify only a single <code>ARRAY JOIN</code> clause in a query.</p>
<p>The query execution order is optimized when running <code>ARRAY JOIN</code>. Although <code>ARRAY JOIN</code> must always be specified before the <code>WHERE/PREWHERE</code> clause, it can be performed either before <code>WHERE/PREWHERE</code> (if the result is needed in this clause), or after completing it (to reduce the volume of calculations). The processing order is controlled by the query optimizer.</p>
<p>Supported types of <code>ARRAY JOIN</code> are listed below:</p>
<ul>
<li><code>ARRAY JOIN</code> - In this case, empty arrays are not included in the result of <code>JOIN</code>.</li>
<li><code>LEFT ARRAY JOIN</code> - The result of <code>JOIN</code> contains rows with empty arrays. The value for an empty array is set to the default value for the array element type (usually 0, empty string or NULL).</li>
</ul>
<p>The examples below demonstrate the usage of the <code>ARRAY JOIN</code> and <code>LEFT ARRAY JOIN</code> clauses. Let's create a table with an <a href="../../data_types/array/">Array</a> type column and insert values into it:</p>
<div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">arrays_test</span>
<span class="p">(</span>
    <span class="n">s</span> <span class="n">String</span><span class="p">,</span>
    <span class="n">arr</span> <span class="nb">Array</span><span class="p">(</span><span class="n">UInt8</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Memory</span><span class="p">;</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">arrays_test</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;World&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;Goodbye&#39;</span><span class="p">,</span> <span class="p">[]);</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s───────────┬─arr─────┐</span>
<span class="err">│ Hello       │ [1,2]   │</span>
<span class="err">│ World       │ [3,4,5] │</span>
<span class="err">│ Goodbye     │ []      │</span>
<span class="err">└─────────────┴─────────┘</span>
</pre></div>


<p>The example below uses the <code>ARRAY JOIN</code> clause:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="n">arr</span>
<span class="k">FROM</span> <span class="n">arrays_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="n">arr</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s─────┬─arr─┐</span>
<span class="err">│ Hello │   1 │</span>
<span class="err">│ Hello │   2 │</span>
<span class="err">│ World │   3 │</span>
<span class="err">│ World │   4 │</span>
<span class="err">│ World │   5 │</span>
<span class="err">└───────┴─────┘</span>
</pre></div>


<p>The next example uses the <code>LEFT ARRAY JOIN</code> clause:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="n">arr</span>
<span class="k">FROM</span> <span class="n">arrays_test</span>
<span class="k">LEFT</span> <span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="n">arr</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s───────────┬─arr─┐</span>
<span class="err">│ Hello       │   1 │</span>
<span class="err">│ Hello       │   2 │</span>
<span class="err">│ World       │   3 │</span>
<span class="err">│ World       │   4 │</span>
<span class="err">│ World       │   5 │</span>
<span class="err">│ Goodbye     │   0 │</span>
<span class="err">└─────────────┴─────┘</span>
</pre></div>


<h4 id="using-aliases">Using Aliases<a class="headerlink" href="#using-aliases" title="Permanent link">&para;</a></h4>
<p>An alias can be specified for an array in the <code>ARRAY JOIN</code> clause. In this case, an array item can be accessed by this alias, but the array itself is accessed by the original name. Example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">a</span>
<span class="k">FROM</span> <span class="n">arrays_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="n">arr</span> <span class="k">AS</span> <span class="n">a</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s─────┬─arr─────┬─a─┐</span>
<span class="err">│ Hello │ [1,2]   │ 1 │</span>
<span class="err">│ Hello │ [1,2]   │ 2 │</span>
<span class="err">│ World │ [3,4,5] │ 3 │</span>
<span class="err">│ World │ [3,4,5] │ 4 │</span>
<span class="err">│ World │ [3,4,5] │ 5 │</span>
<span class="err">└───────┴─────────┴───┘</span>
</pre></div>


<p>Using aliases, you can perform <code>ARRAY JOIN</code> with an external array. For example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="n">arr_external</span>
<span class="k">FROM</span> <span class="n">arrays_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="k">AS</span> <span class="n">arr_external</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s───────────┬─arr_external─┐</span>
<span class="err">│ Hello       │            1 │</span>
<span class="err">│ Hello       │            2 │</span>
<span class="err">│ Hello       │            3 │</span>
<span class="err">│ World       │            1 │</span>
<span class="err">│ World       │            2 │</span>
<span class="err">│ World       │            3 │</span>
<span class="err">│ Goodbye     │            1 │</span>
<span class="err">│ Goodbye     │            2 │</span>
<span class="err">│ Goodbye     │            3 │</span>
<span class="err">└─────────────┴──────────────┘</span>
</pre></div>


<p>Multiple arrays can be comma-separated in the <code>ARRAY JOIN</code> clause. In this case, <code>JOIN</code> is performed with them simultaneously (the direct sum, not the cartesian product). Note that all the arrays must have the same size. Example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">mapped</span>
<span class="k">FROM</span> <span class="n">arrays_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="n">arr</span> <span class="k">AS</span> <span class="n">a</span><span class="p">,</span> <span class="n">arrayEnumerate</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">AS</span> <span class="n">num</span><span class="p">,</span> <span class="n">arrayMap</span><span class="p">(</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span> <span class="k">AS</span> <span class="n">mapped</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s─────┬─arr─────┬─a─┬─num─┬─mapped─┐</span>
<span class="err">│ Hello │ [1,2]   │ 1 │   1 │      2 │</span>
<span class="err">│ Hello │ [1,2]   │ 2 │   2 │      3 │</span>
<span class="err">│ World │ [3,4,5] │ 3 │   1 │      4 │</span>
<span class="err">│ World │ [3,4,5] │ 4 │   2 │      5 │</span>
<span class="err">│ World │ [3,4,5] │ 5 │   3 │      6 │</span>
<span class="err">└───────┴─────────┴───┴─────┴────────┘</span>
</pre></div>


<p>The example below uses the <a href="../functions/array_functions/#array_functions-arrayenumerate">arrayEnumerate</a> function:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="n">arr</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="n">arrayEnumerate</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">arrays_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="n">arr</span> <span class="k">AS</span> <span class="n">a</span><span class="p">,</span> <span class="n">arrayEnumerate</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="k">AS</span> <span class="n">num</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s─────┬─arr─────┬─a─┬─num─┬─arrayEnumerate(arr)─┐</span>
<span class="err">│ Hello │ [1,2]   │ 1 │   1 │ [1,2]               │</span>
<span class="err">│ Hello │ [1,2]   │ 2 │   2 │ [1,2]               │</span>
<span class="err">│ World │ [3,4,5] │ 3 │   1 │ [1,2,3]             │</span>
<span class="err">│ World │ [3,4,5] │ 4 │   2 │ [1,2,3]             │</span>
<span class="err">│ World │ [3,4,5] │ 5 │   3 │ [1,2,3]             │</span>
<span class="err">└───────┴─────────┴───┴─────┴─────────────────────┘</span>
</pre></div>


<h4 id="array-join-with-nested-data-structure">ARRAY JOIN With Nested Data Structure<a class="headerlink" href="#array-join-with-nested-data-structure" title="Permanent link">&para;</a></h4>
<p><code>ARRAY</code>JOIN`` also works with <a href="../../data_types/nested_data_structures/nested/">nested data structures</a>. Example:</p>
<div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">nested_test</span>
<span class="p">(</span>
    <span class="n">s</span> <span class="n">String</span><span class="p">,</span>
    <span class="n">nest</span> <span class="n">Nested</span><span class="p">(</span>
    <span class="n">x</span> <span class="n">UInt8</span><span class="p">,</span>
    <span class="n">y</span> <span class="n">UInt32</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Memory</span><span class="p">;</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">nested_test</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;World&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;Goodbye&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[]);</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s───────┬─nest.x──┬─nest.y─────┐</span>
<span class="err">│ Hello   │ [1,2]   │ [10,20]    │</span>
<span class="err">│ World   │ [3,4,5] │ [30,40,50] │</span>
<span class="err">│ Goodbye │ []      │ []         │</span>
<span class="err">└─────────┴─────────┴────────────┘</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">y</span><span class="o">`</span>
<span class="k">FROM</span> <span class="n">nested_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="n">nest</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s─────┬─nest.x─┬─nest.y─┐</span>
<span class="err">│ Hello │      1 │     10 │</span>
<span class="err">│ Hello │      2 │     20 │</span>
<span class="err">│ World │      3 │     30 │</span>
<span class="err">│ World │      4 │     40 │</span>
<span class="err">│ World │      5 │     50 │</span>
<span class="err">└───────┴────────┴────────┘</span>
</pre></div>


<p>When specifying names of nested data structures in <code>ARRAY JOIN</code>, the meaning is the same as <code>ARRAY JOIN</code> with all the array elements that it consists of. Examples are listed below:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">y</span><span class="o">`</span>
<span class="k">FROM</span> <span class="n">nested_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">y</span><span class="o">`</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s─────┬─nest.x─┬─nest.y─┐</span>
<span class="err">│ Hello │      1 │     10 │</span>
<span class="err">│ Hello │      2 │     20 │</span>
<span class="err">│ World │      3 │     30 │</span>
<span class="err">│ World │      4 │     40 │</span>
<span class="err">│ World │      5 │     50 │</span>
<span class="err">└───────┴────────┴────────┘</span>
</pre></div>


<p>This variation also makes sense:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">y</span><span class="o">`</span>
<span class="k">FROM</span> <span class="n">nested_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s─────┬─nest.x─┬─nest.y─────┐</span>
<span class="err">│ Hello │      1 │ [10,20]    │</span>
<span class="err">│ Hello │      2 │ [10,20]    │</span>
<span class="err">│ World │      3 │ [30,40,50] │</span>
<span class="err">│ World │      4 │ [30,40,50] │</span>
<span class="err">│ World │      5 │ [30,40,50] │</span>
<span class="err">└───────┴────────┴────────────┘</span>
</pre></div>


<p>An alias may be used for a nested data structure, in order to select either the <code>JOIN</code> result or the source array. Example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="o">`</span><span class="n">n</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">n</span><span class="p">.</span><span class="n">y</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">y</span><span class="o">`</span>
<span class="k">FROM</span> <span class="n">nested_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="n">nest</span> <span class="k">AS</span> <span class="n">n</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s─────┬─n.x─┬─n.y─┬─nest.x──┬─nest.y─────┐</span>
<span class="err">│ Hello │   1 │  10 │ [1,2]   │ [10,20]    │</span>
<span class="err">│ Hello │   2 │  20 │ [1,2]   │ [10,20]    │</span>
<span class="err">│ World │   3 │  30 │ [3,4,5] │ [30,40,50] │</span>
<span class="err">│ World │   4 │  40 │ [3,4,5] │ [30,40,50] │</span>
<span class="err">│ World │   5 │  50 │ [3,4,5] │ [30,40,50] │</span>
<span class="err">└───────┴─────┴─────┴─────────┴────────────┘</span>
</pre></div>


<p>Example of using the <a href="../functions/array_functions/#array_functions-arrayenumerate">arrayEnumerate</a> function:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">s</span><span class="p">,</span> <span class="o">`</span><span class="n">n</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">n</span><span class="p">.</span><span class="n">y</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">,</span> <span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">y</span><span class="o">`</span><span class="p">,</span> <span class="n">num</span>
<span class="k">FROM</span> <span class="n">nested_test</span>
<span class="nb">ARRAY</span> <span class="k">JOIN</span> <span class="n">nest</span> <span class="k">AS</span> <span class="n">n</span><span class="p">,</span> <span class="n">arrayEnumerate</span><span class="p">(</span><span class="o">`</span><span class="n">nest</span><span class="p">.</span><span class="n">x</span><span class="o">`</span><span class="p">)</span> <span class="k">AS</span> <span class="n">num</span><span class="p">;</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─s─────┬─n.x─┬─n.y─┬─nest.x──┬─nest.y─────┬─num─┐</span>
<span class="err">│ Hello │   1 │  10 │ [1,2]   │ [10,20]    │   1 │</span>
<span class="err">│ Hello │   2 │  20 │ [1,2]   │ [10,20]    │   2 │</span>
<span class="err">│ World │   3 │  30 │ [3,4,5] │ [30,40,50] │   1 │</span>
<span class="err">│ World │   4 │  40 │ [3,4,5] │ [30,40,50] │   2 │</span>
<span class="err">│ World │   5 │  50 │ [3,4,5] │ [30,40,50] │   3 │</span>
<span class="err">└───────┴─────┴─────┴─────────┴────────────┴─────┘</span>
</pre></div>


<h3 id="select-join">JOIN Clause<a class="headerlink" href="#select-join" title="Permanent link">&para;</a></h3>
<p>Joins the data in the normal <a href="https://en.wikipedia.org/wiki/Join_(SQL)" rel="external nofollow">SQL JOIN</a> sense.</p>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>Not related to <a href="#select-array-join-clause">ARRAY JOIN</a>.</p>
</div>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">expr_list</span><span class="o">&gt;</span>
<span class="k">FROM</span> <span class="o">&lt;</span><span class="n">left_subquery</span><span class="o">&gt;</span>
<span class="p">[</span><span class="k">GLOBAL</span><span class="p">]</span> <span class="p">[</span><span class="k">ANY</span><span class="o">|</span><span class="k">ALL</span><span class="p">]</span> <span class="p">[</span><span class="k">INNER</span><span class="o">|</span><span class="k">LEFT</span><span class="o">|</span><span class="k">RIGHT</span><span class="o">|</span><span class="k">FULL</span><span class="o">|</span><span class="k">CROSS</span><span class="p">]</span> <span class="p">[</span><span class="k">OUTER</span><span class="p">]</span> <span class="k">JOIN</span> <span class="o">&lt;</span><span class="n">right_subquery</span><span class="o">&gt;</span>
<span class="p">(</span><span class="k">ON</span> <span class="o">&lt;</span><span class="n">expr_list</span><span class="o">&gt;</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="k">USING</span> <span class="o">&lt;</span><span class="n">column_list</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">...</span>
</pre></div>


<p>The table names can be specified instead of <code>&lt;left_subquery&gt;</code> and <code>&lt;right_subquery&gt;</code>. This is equivalent to the <code>SELECT * FROM table</code> subquery, except in a special case when the table has the <a href="../../operations/table_engines/join/">Join</a> engine – an array prepared for joining.</p>
<h4 id="select-join-types">Supported Types of <code>JOIN</code><a class="headerlink" href="#select-join-types" title="Permanent link">&para;</a></h4>
<ul>
<li><code>INNER JOIN</code> (or <code>JOIN</code>)</li>
<li><code>LEFT JOIN</code> (or <code>LEFT OUTER JOIN</code>)</li>
<li><code>RIGHT JOIN</code> (or <code>RIGHT OUTER JOIN</code>)</li>
<li><code>FULL JOIN</code> (or <code>FULL OUTER JOIN</code>)</li>
<li><code>CROSS JOIN</code> (or <code>,</code> )</li>
</ul>
<p>See the standard <a href="https://en.wikipedia.org/wiki/Join_(SQL)" rel="external nofollow">SQL JOIN</a> description.</p>
<h4 id="multiple-join">Multiple JOIN<a class="headerlink" href="#multiple-join" title="Permanent link">&para;</a></h4>
<p>Performing queries, ClickHouse rewrites multi-table joins into the sequence of two-table joins. For example, if there are four tables for join ClickHouse joins the first and the second, then joins the result with the third table, and at the last step, it joins the fourth one.</p>
<p>If a query contains the <code>WHERE</code> clause, ClickHouse tries to pushdown filters from this clause through the intermediate join. If it cannot apply the filter to each intermediate join, ClickHouse applies the filters after all joins are completed.</p>
<p>We recommend the <code>JOIN ON</code> or <code>JOIN USING</code> syntax for creating queries. For example:</p>
<div class="codehilite"><pre><span></span><span class="err">SELECT * FROM t1 JOIN t2 ON t1.a = t2.a JOIN t3 ON t1.a = t3.a</span>
</pre></div>


<p>You can use comma-separated lists of tables in the <code>FROM</code> clause. This works only with the <a href="../../operations/settings/settings/#settings-allow_experimental_cross_to_join_conversion">allow_experimental_cross_to_join_conversion = 1</a> setting. For example:</p>
<div class="codehilite"><pre><span></span><span class="err">SELECT * FROM t1, t2, t3 WHERE t1.a = t2.a AND t1.a = t3.a</span>
</pre></div>


<p>Don't mix these syntaxes.</p>
<p>ClickHouse doesn't directly support syntax with commas, so we don't recommend using them. The algorithm tries to rewrite the query in terms of <code>CROSS JOIN</code> and <code>INNER JOIN</code> clauses and then proceeds to query processing. When rewriting the query, ClickHouse tries to optimize performance and memory consumption. By default, ClickHouse treats commas as an <code>INNER JOIN</code> clause and converts <code>INNER JOIN</code> to <code>CROSS JOIN</code> when the algorithm cannot guarantee that <code>INNER JOIN</code> returns the required data.</p>
<h4 id="select-join-strictness">Strictness<a class="headerlink" href="#select-join-strictness" title="Permanent link">&para;</a></h4>
<ul>
<li><code>ALL</code> — If the right table has several matching rows, ClickHouse creates a <a href="https://en.wikipedia.org/wiki/Cartesian_product" rel="external nofollow">Cartesian product</a> from matching rows. This is the standard <code>JOIN</code> behavior in SQL.</li>
<li><code>ANY</code> — If the right table has several matching rows, only the first one found is joined. If the right table has only one matching row, the results of queries with <code>ANY</code> and <code>ALL</code> keywords are the same.</li>
<li><code>ASOF</code> — For joining sequences with a non-exact match. <code>ASOF JOIN</code> usage is described below.</li>
</ul>
<p><strong>ASOF JOIN Usage</strong></p>
<p><code>ASOF JOIN</code> is useful when you need to join records that have no exact match.</p>
<p>Tables for <code>ASOF JOIN</code> must have an ordered sequence column. This column cannot be alone in a table, and should be one of the data types: <code>UInt32</code>, <code>UInt64</code>, <code>Float32</code>, <code>Float64</code>, <code>Date</code>, and <code>DateTime</code>.</p>
<p>You can use the following types of syntax:</p>
<ul>
<li>
<p><code>ASOF JOIN ... ON</code></p>
<p><code>sql
SELECT expressions_list
FROM table_1
ASOF LEFT JOIN table_2
ON equi_cond AND closest_match_cond</code></p>
<p>You can use any number of equality conditions and exactly one closest match condition. For example, <code>SELECT count() FROM A ASOF LEFT JOIN B ON A.a == B.b AND B.t &lt;= A.t</code>. There is just <code>table_2.some_col &lt;= table_1.some_col</code> and <code>table_1.some_col &gt;= table2.some_col</code> types of conditions are available. You cannot apply other conditions like <code>&gt;</code> or <code>!=</code>.</p>
</li>
<li>
<p><code>ASOF JOIN ... USING</code></p>
<p><code>sql
SELECT expressions_list
FROM table_1
ASOF JOIN table_2
USING (equi_column1, ... equi_columnN, asof_column)</code></p>
<p><code>ASOF JOIN</code> uses <code>equi_columnX</code> for joining on equality and <code>asof_column</code> for joining on the closest match with the <code>table_1.asof_column &gt;= table2.asof_column</code> condition. The <code>asof_column</code> column must be the last in the <code>USING</code> clause.</p>
</li>
</ul>
<p>For example, consider the following tables:</p>
<div class="codehilite"><pre><span></span>     <span class="n">table_1</span>                           <span class="n">table_2</span>

  <span class="n">event</span>   <span class="o">|</span> <span class="n">ev_time</span> <span class="o">|</span> <span class="n">user_id</span>       <span class="n">event</span>   <span class="o">|</span> <span class="n">ev_time</span> <span class="o">|</span> <span class="n">user_id</span>
<span class="c1">----------|---------|----------   ----------|---------|----------             </span>
              <span class="p">...</span>                               <span class="p">...</span>
<span class="n">event_1_1</span> <span class="o">|</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">00</span>  <span class="o">|</span>  <span class="mi">42</span>         <span class="n">event_2_1</span> <span class="o">|</span>  <span class="mi">11</span><span class="p">:</span><span class="mi">59</span>  <span class="o">|</span>   <span class="mi">42</span>
              <span class="p">...</span>                 <span class="n">event_2_2</span> <span class="o">|</span>  <span class="mi">12</span><span class="p">:</span><span class="mi">30</span>  <span class="o">|</span>   <span class="mi">42</span>
<span class="n">event_1_2</span> <span class="o">|</span>  <span class="mi">13</span><span class="p">:</span><span class="mi">00</span>  <span class="o">|</span>  <span class="mi">42</span>         <span class="n">event_2_3</span> <span class="o">|</span>  <span class="mi">13</span><span class="p">:</span><span class="mi">00</span>  <span class="o">|</span>   <span class="mi">42</span>
              <span class="p">...</span>                               <span class="p">...</span>
</pre></div>


<p><code>ASOF JOIN</code> can take the timestamp of a user event from <code>table_1</code> and find an event in <code>table_2</code> where the timestamp is closest (equal or less) to the timestamp of the event from <code>table_1</code>. Herewith the <code>user_id</code> column can be used for joining on equality and the <code>ev_time</code> column can be used for joining on the closest match. In our example, <code>event_1_1</code> can be joined with <code>event_2_1</code>, <code>event_1_2</code> can be joined with <code>event_2_3</code>, but <code>event_2_2</code> cannot be joined.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>ASOF</code> join is <strong>not</strong> supported in the <a href="../../operations/table_engines/join/">Join</a> table engine.</p>
</div>
<p>To set the default strictness value, use the session configuration parameter <a href="../../operations/settings/settings/#settings-join_default_strictness">join_default_strictness</a>.</p>
<h4 id="global-join">GLOBAL JOIN<a class="headerlink" href="#global-join" title="Permanent link">&para;</a></h4>
<p>When using a normal <code>JOIN</code>, the query is sent to remote servers. Subqueries are run on each of them in order to make the right table, and the join is performed with this table. In other words, the right table is formed on each server separately.</p>
<p>When using <code>GLOBAL ... JOIN</code>, first the requestor server runs a subquery to calculate the right table. This temporary table is passed to each remote server, and queries are run on them using the temporary data that was transmitted.</p>
<p>Be careful when using <code>GLOBAL</code>. For more information, see the section <a href="#select-distributed-subqueries">Distributed subqueries</a>.</p>
<h4 id="usage-recommendations">Usage Recommendations<a class="headerlink" href="#usage-recommendations" title="Permanent link">&para;</a></h4>
<p>When running a <code>JOIN</code>, there is no optimization of the order of execution in relation to other stages of the query. The join (a search in the right table) is run before filtering in <code>WHERE</code> and before aggregation. In order to explicitly set the processing order, we recommend running a <code>JOIN</code> subquery with a subquery.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">CounterID</span><span class="p">,</span>
    <span class="n">hits</span><span class="p">,</span>
    <span class="n">visits</span>
<span class="k">FROM</span>
<span class="p">(</span>
    <span class="k">SELECT</span>
        <span class="n">CounterID</span><span class="p">,</span>
        <span class="k">count</span><span class="p">()</span> <span class="k">AS</span> <span class="n">hits</span>
    <span class="k">FROM</span> <span class="n">test</span><span class="p">.</span><span class="n">hits</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">CounterID</span>
<span class="p">)</span> <span class="k">ANY</span> <span class="k">LEFT</span> <span class="k">JOIN</span>
<span class="p">(</span>
    <span class="k">SELECT</span>
        <span class="n">CounterID</span><span class="p">,</span>
        <span class="k">sum</span><span class="p">(</span><span class="n">Sign</span><span class="p">)</span> <span class="k">AS</span> <span class="n">visits</span>
    <span class="k">FROM</span> <span class="n">test</span><span class="p">.</span><span class="n">visits</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">CounterID</span>
<span class="p">)</span> <span class="k">USING</span> <span class="n">CounterID</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">hits</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">10</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌─CounterID─┬───hits─┬─visits─┐</span>
<span class="err">│   1143050 │ 523264 │  13665 │</span>
<span class="err">│    731962 │ 475698 │ 102716 │</span>
<span class="err">│    722545 │ 337212 │ 108187 │</span>
<span class="err">│    722889 │ 252197 │  10547 │</span>
<span class="err">│   2237260 │ 196036 │   9522 │</span>
<span class="err">│  23057320 │ 147211 │   7689 │</span>
<span class="err">│    722818 │  90109 │  17847 │</span>
<span class="err">│     48221 │  85379 │   4652 │</span>
<span class="err">│  19762435 │  77807 │   7026 │</span>
<span class="err">│    722884 │  77492 │  11056 │</span>
<span class="err">└───────────┴────────┴────────┘</span>
</pre></div>


<p>Subqueries don't allow you to set names or use them for referencing a column from a specific subquery.
The columns specified in <code>USING</code> must have the same names in both subqueries, and the other columns must be named differently. You can use aliases to change the names of columns in subqueries (the example uses the aliases <code>hits</code> and <code>visits</code>).</p>
<p>The <code>USING</code> clause specifies one or more columns to join, which establishes the equality of these columns. The list of columns is set without brackets. More complex join conditions are not supported.</p>
<p>The right table (the subquery result) resides in RAM. If there isn't enough memory, you can't run a <code>JOIN</code>.</p>
<p>Each time a query is run with the same <code>JOIN</code>, the subquery is run again because the result is not cached. To avoid this, use the special <a href="../../operations/table_engines/join/">Join</a> table engine, which is a prepared array for joining that is always in RAM.</p>
<p>In some cases, it is more efficient to use <code>IN</code> instead of <code>JOIN</code>.
Among the various types of <code>JOIN</code>, the most efficient is <code>ANY LEFT JOIN</code>, then <code>ANY INNER JOIN</code>. The least efficient are <code>ALL LEFT JOIN</code> and <code>ALL INNER JOIN</code>.</p>
<p>If you need a <code>JOIN</code> for joining with dimension tables (these are relatively small tables that contain dimension properties, such as names for advertising campaigns), a <code>JOIN</code> might not be very convenient due to the fact that the right table is re-accessed for every query. For such cases, there is an "external dictionaries" feature that you should use instead of <code>JOIN</code>. For more information, see the section <a href="../dicts/external_dicts/">External dictionaries</a>.</p>
<p><strong>Memory Limitations</strong></p>
<p>ClickHouse uses the <a href="https://en.wikipedia.org/wiki/Hash_join" rel="external nofollow">hash join</a> algorithm. ClickHouse takes the <code>&lt;right_subquery&gt;</code> and creates a hash table for it in RAM. If you need to restrict join operation memory consumption use the following settings:</p>
<ul>
<li><a href="../../operations/settings/query_complexity/#settings-max_rows_in_join">max_rows_in_join</a> — Limits number of rows in the hash table.</li>
<li><a href="../../operations/settings/query_complexity/#settings-max_bytes_in_join">max_bytes_in_join</a> — Limits size of the hash table.</li>
</ul>
<p>When any of these limits is reached, ClickHouse acts as the <a href="../../operations/settings/query_complexity/#settings-join_overflow_mode">join_overflow_mode</a> setting instructs.</p>
<h4 id="processing-of-empty-or-null-cells">Processing of Empty or NULL Cells<a class="headerlink" href="#processing-of-empty-or-null-cells" title="Permanent link">&para;</a></h4>
<p>While joining tables, the empty cells may appear. The setting <a href="../../operations/settings/settings/#settings-join_use_nulls">join_use_nulls</a> define how ClickHouse fills these cells.</p>
<p>If the <code>JOIN</code> keys are <a href="../../data_types/nullable/">Nullable</a> fields, the rows where at least one of the keys has the value <a href="../syntax/#null-literal">NULL</a> are not joined.</p>
<h4 id="syntax-limitations">Syntax Limitations<a class="headerlink" href="#syntax-limitations" title="Permanent link">&para;</a></h4>
<p>For multiple <code>JOIN</code> clauses in a single <code>SELECT</code> query:</p>
<ul>
<li>Taking all the columns via <code>*</code> is available only if tables are joined, not subqueries.</li>
<li>The <code>PREWHERE</code> clause is not available.</li>
</ul>
<p>For <code>ON</code>, <code>WHERE</code>, and <code>GROUP BY</code> clauses:</p>
<ul>
<li>Arbitrary expressions cannot be used in <code>ON</code>, <code>WHERE</code>, and <code>GROUP BY</code> clauses, but you can define an expression in a <code>SELECT</code> clause and then use it in these clauses via an alias.</li>
</ul>
<h3 id="where-clause">WHERE Clause<a class="headerlink" href="#where-clause" title="Permanent link">&para;</a></h3>
<p>If there is a WHERE clause, it must contain an expression with the UInt8 type. This is usually an expression with comparison and logical operators.
This expression will be used for filtering data before all other transformations.</p>
<p>If indexes are supported by the database table engine, the expression is evaluated on the ability to use indexes.</p>
<h3 id="prewhere-clause">PREWHERE Clause<a class="headerlink" href="#prewhere-clause" title="Permanent link">&para;</a></h3>
<p>This clause has the same meaning as the WHERE clause. The difference is in which data is read from the table.
When using PREWHERE, first only the columns necessary for executing PREWHERE are read. Then the other columns are read that are needed for running the query, but only those blocks where the PREWHERE expression is true.</p>
<p>It makes sense to use PREWHERE if there are filtration conditions that are used by a minority of the columns in the query, but that provide strong data filtration. This reduces the volume of data to read.</p>
<p>For example, it is useful to write PREWHERE for queries that extract a large number of columns, but that only have filtration for a few columns.</p>
<p>PREWHERE is only supported by tables from the <code>*MergeTree</code> family.</p>
<p>A query may simultaneously specify PREWHERE and WHERE. In this case, PREWHERE precedes WHERE.</p>
<p>If the 'optimize_move_to_prewhere' setting is set to 1 and PREWHERE is omitted, the system uses heuristics to automatically move parts of expressions from WHERE to PREWHERE.</p>
<h3 id="select-group-by-clause">GROUP BY Clause<a class="headerlink" href="#select-group-by-clause" title="Permanent link">&para;</a></h3>
<p>This is one of the most important parts of a column-oriented DBMS.</p>
<p>If there is a GROUP BY clause, it must contain a list of expressions. Each expression will be referred to here as a "key".
All the expressions in the SELECT, HAVING, and ORDER BY clauses must be calculated from keys or from aggregate functions. In other words, each column selected from the table must be used either in keys or inside aggregate functions.</p>
<p>If a query contains only table columns inside aggregate functions, the GROUP BY clause can be omitted, and aggregation by an empty set of keys is assumed.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="k">count</span><span class="p">(),</span>
    <span class="n">median</span><span class="p">(</span><span class="n">FetchTiming</span> <span class="o">&gt;</span> <span class="mi">60</span> <span class="o">?</span> <span class="mi">60</span> <span class="p">:</span> <span class="n">FetchTiming</span><span class="p">),</span>
    <span class="k">count</span><span class="p">()</span> <span class="o">-</span> <span class="k">sum</span><span class="p">(</span><span class="n">Refresh</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">hits</span>
</pre></div>


<p>However, in contrast to standard SQL, if the table doesn't have any rows (either there aren't any at all, or there aren't any after using WHERE to filter), an empty result is returned, and not the result from one of the rows containing the initial values of aggregate functions.</p>
<p>As opposed to MySQL (and conforming to standard SQL), you can't get some value of some column that is not in a key or aggregate function (except constant expressions). To work around this, you can use the 'any' aggregate function (get the first encountered value) or 'min/max'.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">domainWithoutWWW</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span> <span class="k">AS</span> <span class="k">domain</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(),</span>
    <span class="k">any</span><span class="p">(</span><span class="n">Title</span><span class="p">)</span> <span class="k">AS</span> <span class="n">title</span> <span class="c1">-- getting the first occurred page header for each domain.</span>
<span class="k">FROM</span> <span class="n">hits</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="k">domain</span>
</pre></div>


<p>For every different key value encountered, GROUP BY calculates a set of aggregate function values.</p>
<p>GROUP BY is not supported for array columns.</p>
<p>A constant can't be specified as arguments for aggregate functions. Example: sum(1). Instead of this, you can get rid of the constant. Example: <code>count()</code>.</p>
<h4 id="null-processing">NULL processing<a class="headerlink" href="#null-processing" title="Permanent link">&para;</a></h4>
<p>For grouping, ClickHouse interprets <a href="../syntax/">NULL</a> as a value, and <code>NULL=NULL</code>.</p>
<p>Here's an example to show what this means.</p>
<p>Assume you have this table:</p>
<div class="codehilite"><pre><span></span><span class="err">┌─x─┬────y─┐</span>
<span class="err">│ 1 │    2 │</span>
<span class="err">│ 2 │ ᴺᵁᴸᴸ │</span>
<span class="err">│ 3 │    2 │</span>
<span class="err">│ 3 │    3 │</span>
<span class="err">│ 3 │ ᴺᵁᴸᴸ │</span>
<span class="err">└───┴──────┘</span>
</pre></div>


<p>The query <code>SELECT sum(x), y FROM t_null_big GROUP BY y</code> results in:</p>
<div class="codehilite"><pre><span></span><span class="err">┌─sum(x)─┬────y─┐</span>
<span class="err">│      4 │    2 │</span>
<span class="err">│      3 │    3 │</span>
<span class="err">│      5 │ ᴺᵁᴸᴸ │</span>
<span class="err">└────────┴──────┘</span>
</pre></div>


<p>You can see that <code>GROUP BY</code> for <code>y = NULL</code> summed up <code>x</code>, as if <code>NULL</code> is this value.</p>
<p>If you pass several keys to <code>GROUP BY</code>, the result will give you all the combinations of the selection, as if <code>NULL</code> were a specific value.</p>
<h4 id="with-totals-modifier">WITH TOTALS Modifier<a class="headerlink" href="#with-totals-modifier" title="Permanent link">&para;</a></h4>
<p>If the WITH TOTALS modifier is specified, another row will be calculated. This row will have key columns containing default values (zeros or empty lines), and columns of aggregate functions with the values calculated across all the rows (the "total" values).</p>
<p>This extra row is output in JSON*, TabSeparated*, and Pretty* formats, separately from the other rows. In the other formats, this row is not output.</p>
<p>In JSON* formats, this row is output as a separate 'totals' field. In TabSeparated* formats, the row comes after the main result, preceded by an empty row (after the other data). In Pretty* formats, the row is output as a separate table after the main result.</p>
<p><code>WITH TOTALS</code> can be run in different ways when HAVING is present. The behavior depends on the 'totals_mode' setting.
By default, <code>totals_mode = 'before_having'</code>. In this case, 'totals' is calculated across all rows, including the ones that don't pass through HAVING and 'max_rows_to_group_by'.</p>
<p>The other alternatives include only the rows that pass through HAVING in 'totals', and behave differently with the setting <code>max_rows_to_group_by</code> and <code>group_by_overflow_mode = 'any'</code>.</p>
<p><code>after_having_exclusive</code> – Don't include rows that didn't pass through <code>max_rows_to_group_by</code>. In other words, 'totals' will have less than or the same number of rows as it would if <code>max_rows_to_group_by</code> were omitted.</p>
<p><code>after_having_inclusive</code> – Include all the rows that didn't pass through 'max_rows_to_group_by' in 'totals'. In other words, 'totals' will have more than or the same number of rows as it would if <code>max_rows_to_group_by</code> were omitted.</p>
<p><code>after_having_auto</code> – Count the number of rows that passed through HAVING. If it is more than a certain amount (by default, 50%), include all the rows that didn't pass through 'max_rows_to_group_by' in 'totals'. Otherwise, do not include them.</p>
<p><code>totals_auto_threshold</code> – By default, 0.5. The coefficient for <code>after_having_auto</code>.</p>
<p>If <code>max_rows_to_group_by</code> and <code>group_by_overflow_mode = 'any'</code> are not used, all variations of <code>after_having</code> are the same, and you can use any of them (for example, <code>after_having_auto</code>).</p>
<p>You can use WITH TOTALS in subqueries, including subqueries in the JOIN clause (in this case, the respective total values are combined).</p>
<h4 id="select-group-by-in-external-memory">GROUP BY in External Memory<a class="headerlink" href="#select-group-by-in-external-memory" title="Permanent link">&para;</a></h4>
<p>You can enable dumping temporary data to the disk to restrict memory usage during <code>GROUP BY</code>.
The <a href="../../operations/settings/settings/#settings-max_bytes_before_external_group_by">max_bytes_before_external_group_by</a> setting determines the threshold RAM consumption for dumping <code>GROUP BY</code> temporary data to the file system. If set to 0 (the default), it is disabled.</p>
<p>When using <code>max_bytes_before_external_group_by</code>, we recommend that you set <code>max_memory_usage</code> about twice as high. This is necessary because there are two stages to aggregation: reading the date and forming intermediate data (1) and merging the intermediate data (2). Dumping data to the file system can only occur during stage 1. If the temporary data wasn't dumped, then stage 2 might require up to the same amount of memory as in stage 1.</p>
<p>For example, if <a href="../../operations/settings/settings/#settings_max_memory_usage">max_memory_usage</a> was set to 10000000000 and you want to use external aggregation, it makes sense to set <code>max_bytes_before_external_group_by</code> to 10000000000, and max_memory_usage to 20000000000. When external aggregation is triggered (if there was at least one dump of temporary data), maximum consumption of RAM is only slightly more than <code>max_bytes_before_external_group_by</code>.</p>
<p>With distributed query processing, external aggregation is performed on remote servers. In order for the requester server to use only a small amount of RAM, set <code>distributed_aggregation_memory_efficient</code> to 1.</p>
<p>When merging data flushed to the disk, as well as when merging results from remote servers when the <code>distributed_aggregation_memory_efficient</code> setting is enabled, consumes up to <code>1/256 * the_number_of_threads</code> from the total amount of RAM.</p>
<p>When external aggregation is enabled, if there was less than <code>max_bytes_before_external_group_by</code> of data (i.e. data was not flushed), the query runs just as fast as without external aggregation. If any temporary data was flushed, the run time will be several times longer (approximately three times).</p>
<p>If you have an <code>ORDER BY</code> with a <code>LIMIT</code> after <code>GROUP BY</code>, then the amount of used RAM depends on the amount of data in <code>LIMIT</code>, not in the whole table. But if the <code>ORDER BY</code> doesn't have <code>LIMIT</code>, don't forget to enable external sorting (<code>max_bytes_before_external_sort</code>).</p>
<h3 id="limit-by-clause">LIMIT BY Clause<a class="headerlink" href="#limit-by-clause" title="Permanent link">&para;</a></h3>
<p>A query with the <code>LIMIT n BY expressions</code> clause selects the first <code>n</code> rows for each distinct value of <code>expressions</code>. The key for <code>LIMIT BY</code> can contain any number of <a href="../syntax/#syntax-expressions">expressions</a>.</p>
<p>ClickHouse supports the following syntax:</p>
<ul>
<li><code>LIMIT [offset_value, ]n BY expressions</code></li>
<li><code>LIMIT n OFFSET offset_value BY expressions</code></li>
</ul>
<p>During query processing, ClickHouse selects data ordered by sorting key. The sorting key is set explicitly using an <a href="#select-order-by">ORDER BY</a> clause or implicitly as a property of the table engine. Then ClickHouse applies <code>LIMIT n BY expressions</code> and returns the first <code>n</code> rows for each distinct combination of <code>expressions</code>. If <code>OFFSET</code> is specified, then for each data block that belongs to a distinct combination of <code>expressions</code>, ClickHouse skips <code>offset_value</code> number of rows from the beginning of the block and returns a maximum of <code>n</code> rows as a result. If <code>offset_value</code> is bigger than the number of rows in the data block, ClickHouse returns zero rows from the block.</p>
<p><code>LIMIT BY</code> is not related to <code>LIMIT</code>. They can both be used in the same query.</p>
<p><strong>Examples</strong></p>
<p>Sample table:</p>
<div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">limit_by</span><span class="p">(</span><span class="n">id</span> <span class="nb">Int</span><span class="p">,</span> <span class="n">val</span> <span class="nb">Int</span><span class="p">)</span> <span class="n">ENGINE</span> <span class="o">=</span> <span class="n">Memory</span><span class="p">;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">limit_by</span> <span class="k">values</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">);</span>
</pre></div>


<p>Queries:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">limit_by</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">,</span> <span class="n">val</span> <span class="k">LIMIT</span> <span class="mi">2</span> <span class="k">BY</span> <span class="n">id</span>
</pre></div>


<div class="codehilite"><pre><span></span>┌─id─┬─val─┐
│  1 │  10 │
│  1 │  11 │
│  2 │  20 │
│  2 │  21 │
└────┴─────┘
</pre></div>


<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">limit_by</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">,</span> <span class="n">val</span> <span class="k">LIMIT</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="k">BY</span> <span class="n">id</span>
</pre></div>


<div class="codehilite"><pre><span></span>┌─id─┬─val─┐
│  1 │  11 │
│  1 │  12 │
│  2 │  21 │
└────┴─────┘
</pre></div>


<p>The <code>SELECT * FROM limit_by ORDER BY id, val LIMIT 2 OFFSET 1 BY id</code> query returns the same result.</p>
<p>The following query returns the top 5 referrers for each <code>domain, device_type</code> pair with a maximum of 100 rows in total (<code>LIMIT n BY + LIMIT</code>).</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">domainWithoutWWW</span><span class="p">(</span><span class="n">URL</span><span class="p">)</span> <span class="k">AS</span> <span class="k">domain</span><span class="p">,</span>
    <span class="n">domainWithoutWWW</span><span class="p">(</span><span class="n">REFERRER_URL</span><span class="p">)</span> <span class="k">AS</span> <span class="n">referrer</span><span class="p">,</span>
    <span class="n">device_type</span><span class="p">,</span>
    <span class="k">count</span><span class="p">()</span> <span class="n">cnt</span>
<span class="k">FROM</span> <span class="n">hits</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="k">domain</span><span class="p">,</span> <span class="n">referrer</span><span class="p">,</span> <span class="n">device_type</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">cnt</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">5</span> <span class="k">BY</span> <span class="k">domain</span><span class="p">,</span> <span class="n">device_type</span>
<span class="k">LIMIT</span> <span class="mi">100</span>
</pre></div>


<h3 id="having-clause">HAVING Clause<a class="headerlink" href="#having-clause" title="Permanent link">&para;</a></h3>
<p>Allows filtering the result received after GROUP BY, similar to the WHERE clause.
WHERE and HAVING differ in that WHERE is performed before aggregation (GROUP BY), while HAVING is performed after it.
If aggregation is not performed, HAVING can't be used.</p>
<h3 id="select-order-by">ORDER BY Clause<a class="headerlink" href="#select-order-by" title="Permanent link">&para;</a></h3>
<p>The ORDER BY clause contains a list of expressions, which can each be assigned DESC or ASC (the sorting direction). If the direction is not specified, ASC is assumed. ASC is sorted in ascending order, and DESC in descending order. The sorting direction applies to a single expression, not to the entire list. Example: <code>ORDER BY Visits DESC, SearchPhrase</code></p>
<p>For sorting by String values, you can specify collation (comparison). Example: <code>ORDER BY SearchPhrase COLLATE 'tr'</code> - for sorting by keyword in ascending order, using the Turkish alphabet, case insensitive, assuming that strings are UTF-8 encoded. COLLATE can be specified or not for each expression in ORDER BY independently. If ASC or DESC is specified, COLLATE is specified after it. When using COLLATE, sorting is always case-insensitive.</p>
<p>We only recommend using COLLATE for final sorting of a small number of rows, since sorting with COLLATE is less efficient than normal sorting by bytes.</p>
<p>Rows that have identical values for the list of sorting expressions are output in an arbitrary order, which can also be nondeterministic (different each time).
If the ORDER BY clause is omitted, the order of the rows is also undefined, and may be nondeterministic as well.</p>
<p><code>NaN</code> and <code>NULL</code> sorting order:</p>
<ul>
<li>With the modifier <code>NULLS FIRST</code> — First <code>NULL</code>, then <code>NaN</code>, then other values.</li>
<li>With the modifier <code>NULLS LAST</code> — First the values, then <code>NaN</code>, then <code>NULL</code>.</li>
<li>Default — The same as with the <code>NULLS LAST</code> modifier.</li>
</ul>
<p>Example:</p>
<p>For the table</p>
<div class="codehilite"><pre><span></span><span class="err">┌─x─┬────y─┐</span>
<span class="err">│ 1 │ ᴺᵁᴸᴸ │</span>
<span class="err">│ 2 │    2 │</span>
<span class="err">│ 1 │  nan │</span>
<span class="err">│ 2 │    2 │</span>
<span class="err">│ 3 │    4 │</span>
<span class="err">│ 5 │    6 │</span>
<span class="err">│ 6 │  nan │</span>
<span class="err">│ 7 │ ᴺᵁᴸᴸ │</span>
<span class="err">│ 6 │    7 │</span>
<span class="err">│ 8 │    9 │</span>
<span class="err">└───┴──────┘</span>
</pre></div>


<p>Run the query <code>SELECT * FROM t_null_nan ORDER BY y NULLS FIRST</code> to get:</p>
<div class="codehilite"><pre><span></span><span class="err">┌─x─┬────y─┐</span>
<span class="err">│ 1 │ ᴺᵁᴸᴸ │</span>
<span class="err">│ 7 │ ᴺᵁᴸᴸ │</span>
<span class="err">│ 1 │  nan │</span>
<span class="err">│ 6 │  nan │</span>
<span class="err">│ 2 │    2 │</span>
<span class="err">│ 2 │    2 │</span>
<span class="err">│ 3 │    4 │</span>
<span class="err">│ 5 │    6 │</span>
<span class="err">│ 6 │    7 │</span>
<span class="err">│ 8 │    9 │</span>
<span class="err">└───┴──────┘</span>
</pre></div>


<p>When floating point numbers are sorted, NaNs are separate from the other values. Regardless of the sorting order, NaNs come at the end. In other words, for ascending sorting they are placed as if they are larger than all the other numbers, while for descending sorting they are placed as if they are smaller than the rest.</p>
<p>Less RAM is used if a small enough LIMIT is specified in addition to ORDER BY. Otherwise, the amount of memory spent is proportional to the volume of data for sorting. For distributed query processing, if GROUP BY is omitted, sorting is partially done on remote servers, and the results are merged on the requestor server. This means that for distributed sorting, the volume of data to sort can be greater than the amount of memory on a single server.</p>
<p>If there is not enough RAM, it is possible to perform sorting in external memory (creating temporary files on a disk). Use the setting <code>max_bytes_before_external_sort</code> for this purpose. If it is set to 0 (the default), external sorting is disabled. If it is enabled, when the volume of data to sort reaches the specified number of bytes, the collected data is sorted and dumped into a temporary file. After all data is read, all the sorted files are merged and the results are output. Files are written to the /var/lib/clickhouse/tmp/ directory in the config (by default, but you can use the 'tmp_path' parameter to change this setting).</p>
<p>Running a query may use more memory than 'max_bytes_before_external_sort'. For this reason, this setting must have a value significantly smaller than 'max_memory_usage'. As an example, if your server has 128 GB of RAM and you need to run a single query, set 'max_memory_usage' to 100 GB, and 'max_bytes_before_external_sort' to 80 GB.</p>
<p>External sorting works much less effectively than sorting in RAM.</p>
<h3 id="select-clause">SELECT Clause<a class="headerlink" href="#select-clause" title="Permanent link">&para;</a></h3>
<p>The expressions specified in the SELECT clause are analyzed after the calculations for all the clauses listed above are completed.
More specifically, expressions are analyzed that are above the aggregate functions, if there are any aggregate functions.
The aggregate functions and everything below them are calculated during aggregation (GROUP BY).
These expressions work as if they are applied to separate rows in the result.</p>
<h3 id="select-distinct">DISTINCT Clause<a class="headerlink" href="#select-distinct" title="Permanent link">&para;</a></h3>
<p>If DISTINCT is specified, only a single row will remain out of all the sets of fully matching rows in the result.
The result will be the same as if GROUP BY were specified across all the fields specified in SELECT without aggregate functions. But there are several differences from GROUP BY:</p>
<ul>
<li>DISTINCT can be applied together with GROUP BY.</li>
<li>When ORDER BY is omitted and LIMIT is defined, the query stops running immediately after the required number of different rows has been read.</li>
<li>Data blocks are output as they are processed, without waiting for the entire query to finish running.</li>
</ul>
<p>DISTINCT is not supported if SELECT has at least one array column.</p>
<p><code>DISTINCT</code> works with <a href="../syntax/">NULL</a> as if <code>NULL</code> were a specific value, and <code>NULL=NULL</code>. In other words, in the <code>DISTINCT</code> results, different combinations with <code>NULL</code> only occur once.</p>
<p>ClickHouse supports using the <code>DISTINCT</code> and <code>ORDER BY</code> clauses for different columns in one query. The <code>DISTINCT</code> clause is executed before the <code>ORDER BY</code> clause.</p>
<p>Example table:</p>
<div class="codehilite"><pre><span></span>┌─a─┬─b─┐
│ 2 │ 1 │
│ 1 │ 2 │
│ 3 │ 3 │
│ 2 │ 4 │
└───┴───┘
</pre></div>


<p>When selecting data with the <code>SELECT DISTINCT a FROM t1 ORDER BY b ASC</code> query, we get the following result:</p>
<div class="codehilite"><pre><span></span>┌─a─┐
│ 2 │
│ 1 │
│ 3 │
└───┘
</pre></div>


<p>If we change the sorting direction <code>SELECT DISTINCT a FROM t1 ORDER BY b DESC</code>, we get the following result:</p>
<div class="codehilite"><pre><span></span>┌─a─┐
│ 3 │
│ 1 │
│ 2 │
└───┘
</pre></div>


<p>Row <code>2, 4</code> was cut before sorting.</p>
<p>Take this implementation specificity into account when programming queries.</p>
<h3 id="limit-clause">LIMIT Clause<a class="headerlink" href="#limit-clause" title="Permanent link">&para;</a></h3>
<p><code>LIMIT m</code> allows you to select the first <code>m</code> rows from the result.</p>
<p><code>LIMIT n, m</code> allows you to select the first <code>m</code> rows from the result after skipping the first <code>n</code> rows. The <code>LIMIT m OFFSET n</code> syntax is also supported.</p>
<p><code>n</code> and <code>m</code> must be non-negative integers.</p>
<p>If there isn't an <code>ORDER BY</code> clause that explicitly sorts results, the result may be arbitrary and nondeterministic.</p>
<h3 id="union-all-clause">UNION ALL Clause<a class="headerlink" href="#union-all-clause" title="Permanent link">&para;</a></h3>
<p>You can use UNION ALL to combine any number of queries. Example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">CounterID</span><span class="p">,</span> <span class="mi">1</span> <span class="k">AS</span> <span class="k">table</span><span class="p">,</span> <span class="n">toInt64</span><span class="p">(</span><span class="k">count</span><span class="p">())</span> <span class="k">AS</span> <span class="k">c</span>
    <span class="k">FROM</span> <span class="n">test</span><span class="p">.</span><span class="n">hits</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">CounterID</span>

<span class="k">UNION</span> <span class="k">ALL</span>

<span class="k">SELECT</span> <span class="n">CounterID</span><span class="p">,</span> <span class="mi">2</span> <span class="k">AS</span> <span class="k">table</span><span class="p">,</span> <span class="k">sum</span><span class="p">(</span><span class="n">Sign</span><span class="p">)</span> <span class="k">AS</span> <span class="k">c</span>
    <span class="k">FROM</span> <span class="n">test</span><span class="p">.</span><span class="n">visits</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">CounterID</span>
    <span class="k">HAVING</span> <span class="k">c</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div>


<p>Only UNION ALL is supported. The regular UNION (UNION DISTINCT) is not supported. If you need UNION DISTINCT, you can write SELECT DISTINCT from a subquery containing UNION ALL.</p>
<p>Queries that are parts of UNION ALL can be run simultaneously, and their results can be mixed together.</p>
<p>The structure of results (the number and type of columns) must match for the queries. But the column names can differ. In this case, the column names for the final result will be taken from the first query. Type casting is performed for unions. For example, if two queries being combined have the same field with non-<code>Nullable</code> and <code>Nullable</code> types from a compatible type, the resulting <code>UNION ALL</code> has a <code>Nullable</code> type field.</p>
<p>Queries that are parts of UNION ALL can't be enclosed in brackets. ORDER BY and LIMIT are applied to separate queries, not to the final result. If you need to apply a conversion to the final result, you can put all the queries with UNION ALL in a subquery in the FROM clause.</p>
<h3 id="into-outfile-clause">INTO OUTFILE Clause<a class="headerlink" href="#into-outfile-clause" title="Permanent link">&para;</a></h3>
<p>Add the <code>INTO OUTFILE filename</code> clause (where filename is a string literal) to redirect query output to the specified file.
In contrast to MySQL, the file is created on the client side. The query will fail if a file with the same filename already exists.
This functionality is available in the command-line client and clickhouse-local (a query sent via HTTP interface will fail).</p>
<p>The default output format is TabSeparated (the same as in the command-line client batch mode).</p>
<h3 id="format-clause">FORMAT Clause<a class="headerlink" href="#format-clause" title="Permanent link">&para;</a></h3>
<p>Specify 'FORMAT format' to get data in any specified format.
You can use this for convenience, or for creating dumps.
For more information, see the section "Formats".
If the FORMAT clause is omitted, the default format is used, which depends on both the settings and the interface used for accessing the DB. For the HTTP interface and the command-line client in batch mode, the default format is TabSeparated. For the command-line client in interactive mode, the default format is PrettyCompact (it has attractive and compact tables).</p>
<p>When using the command-line client, data is passed to the client in an internal efficient format. The client independently interprets the FORMAT clause of the query and formats the data itself (thus relieving the network and the server from the load).</p>
<h3 id="select-in-operators">IN Operators<a class="headerlink" href="#select-in-operators" title="Permanent link">&para;</a></h3>
<p>The <code>IN</code>, <code>NOT IN</code>, <code>GLOBAL IN</code>, and <code>GLOBAL NOT IN</code> operators are covered separately, since their functionality is quite rich.</p>
<p>The left side of the operator is either a single column or a tuple.</p>
<p>Examples:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">UserID</span> <span class="k">IN</span> <span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="mi">456</span><span class="p">)</span> <span class="k">FROM</span> <span class="p">...</span>
<span class="k">SELECT</span> <span class="p">(</span><span class="n">CounterID</span><span class="p">,</span> <span class="n">UserID</span><span class="p">)</span> <span class="k">IN</span> <span class="p">((</span><span class="mi">34</span><span class="p">,</span> <span class="mi">123</span><span class="p">),</span> <span class="p">(</span><span class="mi">101500</span><span class="p">,</span> <span class="mi">456</span><span class="p">))</span> <span class="k">FROM</span> <span class="p">...</span>
</pre></div>


<p>If the left side is a single column that is in the index, and the right side is a set of constants, the system uses the index for processing the query.</p>
<p>Don't list too many values explicitly (i.e. millions). If a data set is large, put it in a temporary table (for example, see the section "External data for query processing"), then use a subquery.</p>
<p>The right side of the operator can be a set of constant expressions, a set of tuples with constant expressions (shown in the examples above), or the name of a database table or SELECT subquery in brackets.</p>
<p>If the right side of the operator is the name of a table (for example, <code>UserID IN users</code>), this is equivalent to the subquery <code>UserID IN (SELECT * FROM users)</code>. Use this when working with external data that is sent along with the query. For example, the query can be sent together with a set of user IDs loaded to the 'users' temporary table, which should be filtered.</p>
<p>If the right side of the operator is a table name that has the Set engine (a prepared data set that is always in RAM), the data set will not be created over again for each query.</p>
<p>The subquery may specify more than one column for filtering tuples.
Example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="p">(</span><span class="n">CounterID</span><span class="p">,</span> <span class="n">UserID</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">CounterID</span><span class="p">,</span> <span class="n">UserID</span> <span class="k">FROM</span> <span class="p">...)</span> <span class="k">FROM</span> <span class="p">...</span>
</pre></div>


<p>The columns to the left and right of the IN operator should have the same type.</p>
<p>The IN operator and subquery may occur in any part of the query, including in aggregate functions and lambda functions.
Example:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span>
    <span class="n">EventDate</span><span class="p">,</span>
    <span class="k">avg</span><span class="p">(</span><span class="n">UserID</span> <span class="k">IN</span>
    <span class="p">(</span>
        <span class="k">SELECT</span> <span class="n">UserID</span>
        <span class="k">FROM</span> <span class="n">test</span><span class="p">.</span><span class="n">hits</span>
        <span class="k">WHERE</span> <span class="n">EventDate</span> <span class="o">=</span> <span class="n">toDate</span><span class="p">(</span><span class="s1">&#39;2014-03-17&#39;</span><span class="p">)</span>
    <span class="p">))</span> <span class="k">AS</span> <span class="n">ratio</span>
<span class="k">FROM</span> <span class="n">test</span><span class="p">.</span><span class="n">hits</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">EventDate</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">EventDate</span> <span class="k">ASC</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="err">┌──EventDate─┬────ratio─┐</span>
<span class="err">│ 2014-03-17 │        1 │</span>
<span class="err">│ 2014-03-18 │ 0.807696 │</span>
<span class="err">│ 2014-03-19 │ 0.755406 │</span>
<span class="err">│ 2014-03-20 │ 0.723218 │</span>
<span class="err">│ 2014-03-21 │ 0.697021 │</span>
<span class="err">│ 2014-03-22 │ 0.647851 │</span>
<span class="err">│ 2014-03-23 │ 0.648416 │</span>
<span class="err">└────────────┴──────────┘</span>
</pre></div>


<p>For each day after March 17th, count the percentage of pageviews made by users who visited the site on March 17th.
A subquery in the IN clause is always run just one time on a single server. There are no dependent subqueries.</p>
<h4 id="null-processing_1">NULL processing<a class="headerlink" href="#null-processing_1" title="Permanent link">&para;</a></h4>
<p>During request processing, the IN operator assumes that the result of an operation with <a href="../syntax/">NULL</a> is always equal to <code>0</code>, regardless of whether <code>NULL</code> is on the right or left side of the operator. <code>NULL</code> values are not included in any dataset, do not correspond to each other and cannot be compared.</p>
<p>Here is an example with the <code>t_null</code> table:</p>
<div class="codehilite"><pre><span></span><span class="err">┌─x─┬────y─┐</span>
<span class="err">│ 1 │ ᴺᵁᴸᴸ │</span>
<span class="err">│ 2 │    3 │</span>
<span class="err">└───┴──────┘</span>
</pre></div>


<p>Running the query <code>SELECT x FROM t_null WHERE y IN (NULL,3)</code> gives you the following result:</p>
<div class="codehilite"><pre><span></span><span class="err">┌─x─┐</span>
<span class="err">│ 2 │</span>
<span class="err">└───┘</span>
</pre></div>


<p>You can see that the row in which <code>y = NULL</code> is thrown out of the query results. This is because ClickHouse can't decide whether <code>NULL</code> is included in the <code>(NULL,3)</code> set, returns <code>0</code> as the result of the operation, and <code>SELECT</code> excludes this row from the final output.</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">y</span> <span class="k">IN</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">t_null</span>

<span class="err">┌─</span><span class="k">in</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">tuple</span><span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="err">─┐</span>
<span class="err">│</span>                     <span class="mi">0</span> <span class="err">│</span>
<span class="err">│</span>                     <span class="mi">1</span> <span class="err">│</span>
<span class="err">└───────────────────────┘</span>
</pre></div>


<h4 id="select-distributed-subqueries">Distributed Subqueries<a class="headerlink" href="#select-distributed-subqueries" title="Permanent link">&para;</a></h4>
<p>There are two options for IN-s with subqueries (similar to JOINs): normal <code>IN</code> / <code>JOIN</code> and <code>GLOBAL IN</code> / <code>GLOBAL JOIN</code>. They differ in how they are run for distributed query processing.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Remember that the algorithms described below may work differently depending on the <a href="../../operations/settings/settings/">settings</a> <code>distributed_product_mode</code> setting.</p>
</div>
<p>When using the regular IN, the query is sent to remote servers, and each of them runs the subqueries in the <code>IN</code> or <code>JOIN</code> clause.</p>
<p>When using <code>GLOBAL IN</code> / <code>GLOBAL JOINs</code>, first all the subqueries are run for <code>GLOBAL IN</code> / <code>GLOBAL JOINs</code>, and the results are collected in temporary tables. Then the temporary tables are sent to each remote server, where the queries are run using this temporary data.</p>
<p>For a non-distributed query, use the regular <code>IN</code> / <code>JOIN</code>.</p>
<p>Be careful when using subqueries in the <code>IN</code> / <code>JOIN</code> clauses for distributed query processing.</p>
<p>Let's look at some examples. Assume that each server in the cluster has a normal <strong>local_table</strong>. Each server also has a <strong>distributed_table</strong> table with the <strong>Distributed</strong> type, which looks at all the servers in the cluster.</p>
<p>For a query to the <strong>distributed_table</strong>, the query will be sent to all the remote servers and run on them using the <strong>local_table</strong>.</p>
<p>For example, the query</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">uniq</span><span class="p">(</span><span class="n">UserID</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">distributed_table</span>
</pre></div>


<p>will be sent to all remote servers as</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">uniq</span><span class="p">(</span><span class="n">UserID</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">local_table</span>
</pre></div>


<p>and run on each of them in parallel, until it reaches the stage where intermediate results can be combined. Then the intermediate results will be returned to the requestor server and merged on it, and the final result will be sent to the client.</p>
<p>Now let's examine a query with IN:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">uniq</span><span class="p">(</span><span class="n">UserID</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">distributed_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">101500</span> <span class="k">AND</span> <span class="n">UserID</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">UserID</span> <span class="k">FROM</span> <span class="n">local_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">34</span><span class="p">)</span>
</pre></div>


<ul>
<li>Calculation of the intersection of audiences of two sites.</li>
</ul>
<p>This query will be sent to all remote servers as</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">uniq</span><span class="p">(</span><span class="n">UserID</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">local_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">101500</span> <span class="k">AND</span> <span class="n">UserID</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">UserID</span> <span class="k">FROM</span> <span class="n">local_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">34</span><span class="p">)</span>
</pre></div>


<p>In other words, the data set in the IN clause will be collected on each server independently, only across the data that is stored locally on each of the servers.</p>
<p>This will work correctly and optimally if you are prepared for this case and have spread data across the cluster servers such that the data for a single UserID resides entirely on a single server. In this case, all the necessary data will be available locally on each server. Otherwise, the result will be inaccurate. We refer to this variation of the query as "local IN".</p>
<p>To correct how the query works when data is spread randomly across the cluster servers, you could specify <strong>distributed_table</strong> inside a subquery. The query would look like this:</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">uniq</span><span class="p">(</span><span class="n">UserID</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">distributed_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">101500</span> <span class="k">AND</span> <span class="n">UserID</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">UserID</span> <span class="k">FROM</span> <span class="n">distributed_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">34</span><span class="p">)</span>
</pre></div>


<p>This query will be sent to all remote servers as</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">uniq</span><span class="p">(</span><span class="n">UserID</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">local_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">101500</span> <span class="k">AND</span> <span class="n">UserID</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">UserID</span> <span class="k">FROM</span> <span class="n">distributed_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">34</span><span class="p">)</span>
</pre></div>


<p>The subquery will begin running on each remote server. Since the subquery uses a distributed table, the subquery that is on each remote server will be resent to every remote server as</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">UserID</span> <span class="k">FROM</span> <span class="n">local_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">34</span>
</pre></div>


<p>For example, if you have a cluster of 100 servers, executing the entire query will require 10,000 elementary requests, which is generally considered unacceptable.</p>
<p>In such cases, you should always use GLOBAL IN instead of IN. Let's look at how it works for the query</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">uniq</span><span class="p">(</span><span class="n">UserID</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">distributed_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">101500</span> <span class="k">AND</span> <span class="n">UserID</span> <span class="k">GLOBAL</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">UserID</span> <span class="k">FROM</span> <span class="n">distributed_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">34</span><span class="p">)</span>
</pre></div>


<p>The requestor server will run the subquery</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">UserID</span> <span class="k">FROM</span> <span class="n">distributed_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">34</span>
</pre></div>


<p>and the result will be put in a temporary table in RAM. Then the request will be sent to each remote server as</p>
<div class="codehilite"><pre><span></span><span class="k">SELECT</span> <span class="n">uniq</span><span class="p">(</span><span class="n">UserID</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">local_table</span> <span class="k">WHERE</span> <span class="n">CounterID</span> <span class="o">=</span> <span class="mi">101500</span> <span class="k">AND</span> <span class="n">UserID</span> <span class="k">GLOBAL</span> <span class="k">IN</span> <span class="n">_data1</span>
</pre></div>


<p>and the temporary table <code>_data1</code> will be sent to every remote server with the query (the name of the temporary table is implementation-defined).</p>
<p>This is more optimal than using the normal IN. However, keep the following points in mind:</p>
<ol>
<li>When creating a temporary table, data is not made unique. To reduce the volume of data transmitted over the network, specify DISTINCT in the subquery. (You don't need to do this for a normal IN.)</li>
<li>The temporary table will be sent to all the remote servers. Transmission does not account for network topology. For example, if 10 remote servers reside in a datacenter that is very remote in relation to the requestor server, the data will be sent 10 times over the channel to the remote datacenter. Try to avoid large data sets when using GLOBAL IN.</li>
<li>When transmitting data to remote servers, restrictions on network bandwidth are not configurable. You might overload the network.</li>
<li>Try to distribute data across servers so that you don't need to use GLOBAL IN on a regular basis.</li>
<li>If you need to use GLOBAL IN often, plan the location of the ClickHouse cluster so that a single group of replicas resides in no more than one data center with a fast network between them, so that a query can be processed entirely within a single data center.</li>
</ol>
<p>It also makes sense to specify a local table in the <code>GLOBAL IN</code> clause, in case this local table is only available on the requestor server and you want to use data from it on remote servers.</p>
<h3 id="extreme-values">Extreme Values<a class="headerlink" href="#extreme-values" title="Permanent link">&para;</a></h3>
<p>In addition to results, you can also get minimum and maximum values for the results columns. To do this, set the <strong>extremes</strong> setting to 1. Minimums and maximums are calculated for numeric types, dates, and dates with times. For other columns, the default values are output.</p>
<p>An extra two rows are calculated – the minimums and maximums, respectively. These extra two rows are output in <code>JSON*</code>, <code>TabSeparated*</code>, and <code>Pretty*</code> <a href="../../interfaces/formats/">formats</a>, separate from the other rows. They are not output for other formats.</p>
<p>In <code>JSON*</code> formats, the extreme values are output in a separate 'extremes' field. In <code>TabSeparated*</code> formats, the row comes after the main result, and after 'totals' if present. It is preceded by an empty row (after the other data). In <code>Pretty*</code> formats, the row is output as a separate table after the main result, and after <code>totals</code> if present.</p>
<p>Extreme values are calculated for rows before <code>LIMIT</code>, but after <code>LIMIT BY</code>. However, when using <code>LIMIT offset, size</code>, the rows before <code>offset</code> are included in <code>extremes</code>. In stream requests, the result may also include a small number of rows that passed through <code>LIMIT</code>.</p>
<h3 id="notes">Notes<a class="headerlink" href="#notes" title="Permanent link">&para;</a></h3>
<p>The <code>GROUP BY</code> and <code>ORDER BY</code> clauses do not support positional arguments. This contradicts MySQL, but conforms to standard SQL.
For example, <code>GROUP BY 1, 2</code> will be interpreted as grouping by constants (i.e. aggregation of all rows into one).</p>
<p>You can use synonyms (<code>AS</code> aliases) in any part of a query.</p>
<p>You can put an asterisk in any part of a query instead of an expression. When the query is analyzed, the asterisk is expanded to a list of all table columns (excluding the <code>MATERIALIZED</code> and <code>ALIAS</code> columns). There are only a few cases when using an asterisk is justified:</p>
<ul>
<li>When creating a table dump.</li>
<li>For tables containing just a few columns, such as system tables.</li>
<li>For getting information about what columns are in a table. In this case, set <code>LIMIT 1</code>. But it is better to use the <code>DESC TABLE</code> query.</li>
<li>When there is strong filtration on a small number of columns using <code>PREWHERE</code>.</li>
<li>In subqueries (since columns that aren't needed for the external query are excluded from subqueries).</li>
</ul>
<p>In all other cases, we don't recommend using the asterisk, since it only gives you the drawbacks of a columnar DBMS instead of the advantages. In other words using the asterisk is not recommended.</p>
                
                </div>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        
          <a href="../../operations/table_engines/buffer/" title="Buffer" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  قبلی
                </span>
                Buffer
              </span>
            </div>
          </a>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        
          <a href="../../query_language/insert_into/" title="INSERT INTO" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  بعدی
                </span>
                INSERT INTO
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            ©2016–2020 Yandex LLC
          </div>
        
      </div>
      
        <div class="md-footer-social">
  <span class="md-footer-copyright__highlight">Built from <a href="https://github.com/ClickHouse/ClickHouse/commit/96b39be564971666bce90de0b25b2540ab03cb18" rel="external nofollow">96b39be</a></span>
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      
        <script src="../../assets/javascripts/modernizr.js"></script>
      
      <script src="../../assets/javascripts/application.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              <script src="../../assets/javascripts/lunr/lunr.fa.js"></script>
            
          
          
            <script src="../../assets/javascripts/lunr/lunr.multi.js"></script>
          
        
      
      
    
    
      
    

    <script type="text/javascript">
      function ready(callback){
          if (document.readyState != 'loading') {
              callback();
          } else if (document.addEventListener) {
              document.addEventListener('DOMContentLoaded', callback);
          } else document.attachEvent('onreadystatechange', function() {
              if (document.readyState == 'complete') {
                  callback();
              }
          });
      }
      ready(function () {
          var i;
          
          app.initialize({
              version: "1.0.4",
              url: {
                  base: "../.."
              }
          });
          var beforePrint = function() {
            var details = document.getElementsByTagName("details");
            for (i = 0; i < details.length; ++i) {
                details[i].open = 1;
            }
          };
          if (window.matchMedia) {
              window.matchMedia('print').addListener(function(q) {
                  if (q.matches) {
                      beforePrint();
                  }
              });
          }
          window.onbeforeprint = beforePrint;

          var name = window.location.hostname.split('.')[0];
          var feedback_address = name + '-feedback' + '@yandex-team.ru';
          var feedback_email = document.getElementsByClassName('feedback-email');
          for (i = 0; i < feedback_email.length; i++) {
            feedback_email[i].setAttribute('href', 'mailto:' + feedback_address);
            feedback_email[i].innerHTML = feedback_address;
          }

          document.getElementById("releases-selector").addEventListener(
            "change",
            function() {
              var target = window.location.href.split('docs')[0] + 'docs/';
              if (this.value) {
                target = target + this.value + '/';
              }
              window.location = target + 'fa';
            }
          )
      });
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script type="text/javascript"> docsearch({
apiKey: 'e239649803024433599de47a53b2d416',
indexName: 'yandex_clickhouse',
inputSelector: '#md-search__input',
algoliaOptions: {
  advancedSyntax: true,
  clickAnalytics: true,
  hitsPerPage: 25,
  'facetFilters': ["lang:fa"]
},
debug: false
});
</script>

    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function (d, w, c) {
            (w[c] = w[c] || []).push(function() {
                try {
                    w.yaCounter18343495 = new Ya.Metrika2({
                        id:18343495,
                        clickmap:true,
                        trackLinks:true,
                        accurateTrackBounce:true,
                        webvisor: true
                    });
                } catch(e) { }
            });
            var n = d.getElementsByTagName("script")[0],
                s = d.createElement("script"),
                f = function () { n.parentNode.insertBefore(s, n); };
            s.type = "text/javascript";
            s.async = true;
            s.src = "https://mc.yandex.ru/metrika/tag.js";
            if (w.opera == "[object Opera]") {
                d.addEventListener("DOMContentLoaded", f, false);
            } else { f(); }
        })(document, window, "yandex_metrika_callbacks2");
    </script>
    <noscript>
        <div><img src="https://mc.yandex.ru/watch/18343495" style="position:absolute; left:-9999px;" alt=""/></div>
    </noscript>
    <!-- /Yandex.Metrika counter -->
  </body>
</html>